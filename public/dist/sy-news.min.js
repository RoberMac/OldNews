angular.module("ShinyaNews",["ngTouch","ngAnimate","angular-storage","ShinyaNews.stopPropagationDirective","ShinyaNews.timeHelperServices"]).factory("oneDayStore",["store",function(e){return e.getNamespacedStore("one-day-news","-")}]).controller("rootController",["$scope","$http","$timeout","$window","store","oneDayStore","syNewsTimeHelper",function(e,t,s,n,o,i,a){function l(n){e.isOldNews?w():c();var o,a=n.selectDate+e.selectCountry;return e.newsBox=[],e.isShow=!1,e.isNewsExist=!0,(o=n.isAllDay?f[a]:i.get(a))?(e.newsBox=o,e.isShow=!0,void(e.isNewsExist=!0)):void t.post("/api/getSelectedDateNews",n).success(function(t,n,o,i){i.data.isAllDay?f[a]=t.msg:r(a,t.msg),s(function(){e.newsBox=t.msg,e.isShow=!0,e.isNewsExist=!0},717)}).error(function(t,n,o,i){s(function(){e.newsBox=[],e.isShow=!0,e.isNewsExist=!1},717)})}function c(){var t=e.selectNewsInfo.selectDate;e.isHideCaretLeft=t-36e5===a.getDayMs(new Date)?!0:!1,e.isHideCaretRight=t+36e5>Date.now()?!0:!1}function w(){var t=e.selectOldNewsInfo.selectDate;e.isHideCaretLeft=!1,e.isHideCaretRight=t+1728e5>Date.now()?!0:!1}function r(e,t){i.set(e,t);var s=Date.now()+864e5;o.set("oneDayNewsExpires",a.getDayMs(s))}function D(){for(var e=n.localStorage,t=localStorage.length,s=/^one-day-news-/,i=0,a=0;t>a;a++)s.test(e.key(i))?o.remove(e.key(i)):i++}e.isShow=!1,e.isNewsExist=!0,e.isOldNews=!1,e.isShowTimeMachine=!1,e.toggleNews=function(){e.isOldNews=!e.isOldNews,angular.element(document.documentElement).toggleClass("oldNews"),l(e.isOldNews?e.selectOldNewsInfo:e.selectNewsInfo)},e.toggleTimeMachine=function(){e.timeMachineInfo={H:new Date(e.selectNewsInfo.selectDate).getHours(),M:new Date(e.selectOldNewsInfo.selectDate).getMonth()+1,D:new Date(e.selectOldNewsInfo.selectDate).getDate()},e.isShowTimeMachine=!e.isShowTimeMachine};var f={};e.newsBox=[],e.selectCountry="CN",e.selectNewsInfo={selectDate:a.getHoursMs((new Date).getHours()),selectCountry:e.selectCountry,isAllDay:!1},e.selectOldNewsInfo={selectDate:a.getDayMs(Date.now())-864e5,selectCountry:e.selectCountry,isAllDay:!0},e.timeMachineInfo={H:(new Date).getHours(),M:(new Date).getMonth()+1,D:(new Date).getDate()},e.isHideCaretLeft=!1,e.isHideCaretRight=!1,e.selectNews=function(t){e.isOldNews?(e.selectOldNewsInfo.selectDate+=864e5*t,l(e.selectOldNewsInfo)):(e.selectNewsInfo.selectDate+=36e5*t,l(e.selectNewsInfo))},e.timeMachineSelectNews=function(){e.isOldNews?(e.selectOldNewsInfo.selectDate=a.getDayMs(new Date(2015,e.timeMachineInfo.M-1,e.timeMachineInfo.D)),l(e.selectOldNewsInfo)):(e.selectNewsInfo.selectDate=a.getHoursMs(e.timeMachineInfo.H),l(e.selectNewsInfo)),e.isShowTimeMachine=!1},c(),l(e.selectNewsInfo),o.get("oneDayNewsExpires")<Date.now()?D():null}]);
angular.module("ShinyaNews.stopPropagationDirective",[]).directive("syNewsStopPropagation",function(){return{restrict:"A",link:function(t,i,n){i.bind("click",function(t){t.stopPropagation()}),i.bind("touchstart",function(t){t.stopPropagation()})}}});
angular.module("ShinyaNews.timeHelperServices",[]).service("syNewsTimeHelper",function(){this.getHoursMs=function(e){var t=new Date,a=t.getTimezoneOffset()/60;return Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),e+a)},this.getDayMs=function(e){var e=new Date(e);return Date.parse(new Date(e.getFullYear(),e.getMonth(),e.getDate()))}});
//# sourceMappingURL=sy-news.min.js.map