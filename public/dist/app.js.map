{"version":3,"sources":["entry.js","templates.js","Nav/Nav.js","NewsBox/NewsBox.js","TimeMachine/TimeMachine.js","utils.js","controllers/rootCtrl.js","directives/syAutofocus.js","directives/syIcon.js","directives/syStopPropagation.js","services/FetchNews.js","services/TimeHelper.js","services/store.js"],"names":["config","$locationProvider","$stateProvider","$urlRouterProvider","otherwise","now","Date","year","getFullYear","month","getMonth","day","getDate","h","getHours","country","angular","fromJson","window","localStorage","getItem","html5Mode","state","url","join","templateUrl","controller","controllerAs","$inject","module","run","$templateCache","put","syNav","restrict","replace","NavCtrl","$scope","$window","$timeout","$state","$stateParams","store","COUNTRIES","TIME","TimeHelper","selectNews","step","nextDate","nextHour","isOldNews","rootVM","newsDate","newsDateMs","vm","isShowCaretRight","isShowCaretLeft","dateFormatter","ONE_DAY","go","q","parseInt","handleKeyDownEsc","countryList","getCountryList","handleKeyDownLeftOrRightArrow","event","payload","handleSwipeLeftOrRight","handleStartFetchNews","TWO_DAYS","ONE_HOUR","todayMs","togglehNewsType","nowHourMs","hour","handleCountryClick","newCountry","toggleCountryList","activeCounty","cache","length","forEach","push","hideCountryList","preList","copy","index","indexOf","splice","unshift","get","this","$on","constant","directive","NewsBoxCtrl","$rootScope","$location","FetchNews","updateState","newState","merge","updateQueryParam","title","searchText","notify","reload","handleSwipe","$broadcast","handleHeadingClick","document","querySelector","blur","handleKeyDownUpOrDownArrow","newsItemList","querySelectorAll","len","selectedNewsIndex","focus","fetchNews","isToday","date","set","then","newsData","isFetching","isFetchFail","syTimeMachine","TimeMachineCtrl","toggleTimeMachine","timeMachine","Y","M","D","H","isShowTimeMachine","handleSubmit","dateValidation","expectDate","maxDate","form","$setValidity","rootCtrl","handleKeyDown","e","keyCode","target","tagName","toLowerCase","element","on","autoFocus","scope","link","$elem","$attr","timeout","syAutoFocus","syIcon","template","viewBox","viewbox","name","stopPropagation","NewsStore","STORE_PREFIX","newsID","news","removeAll","i","j","ls","reg","RegExp","test","key","remove","OldNewsStore","$cacheFactory","$q","$http","newsId","localNewsData","resolve","reject","success","data","msg","error","factory","dateMs","_parseJSON","value","setItem","toJson","removeItem"],"mappings":"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","file":"app.js","sourcesContent":["/* eslint angular/window-service: 0 */\n\nconfig.$inject = [\"$locationProvider\", \"$stateProvider\", \"$urlRouterProvider\"];\nangular\n.module('ShinyaNews', [\n    // Vendors\n    'ngTouch',\n    'ngAnimate',\n    'ui.router',\n    // App\n    'ShinyaNews.utils.controllers',\n    'ShinyaNews.utils.services',\n    'ShinyaNews.utils.directives',\n    'ShinyaNews.components.NewsBox',\n    'ShinyaNews.components.TimeMachine',\n    'ShinyaNews.components.Nav',\n    'ShinyaNews.templates'\n])\n.config(config);\n\n\nfunction config($locationProvider, $stateProvider, $urlRouterProvider) {\n    $urlRouterProvider.otherwise(function () {\n        var now = new Date();\n        var year = now.getFullYear();\n        var month = now.getMonth() + 1;\n        var day = now.getDate();\n        var h = now.getHours();\n        var country = angular.fromJson(window.localStorage.getItem('sy-country')) || 'HK';\n\n        return country + '/' + year + '/' + month + '/' + day + '?h=' + h;\n    });\n\n    $locationProvider.html5Mode(true);\n\n    $stateProvider\n    .state('news', {\n        url: [\n            '/{country:BR|CN|DE|FR|HK|IN|JP|KR|RU|TW|US}', // Country\n            '/{year:201[5-6]}', // Year\n            '/{month:0?[1-9]|1[0-2]}', // Month\n            '/{day:0?[0-9]|[12][0-9]|3[0-1]}', // Day\n            '?h', // Hour\n            '&q' // Search\n        ].join(''),\n        templateUrl : 'components/NewsBox/NewsBox.html',\n        controller  : 'NewsBoxCtrl',\n        controllerAs: 'newsVM'\n    });\n}\n","angular.module(\"ShinyaNews.templates\", []).run([\"$templateCache\", function($templateCache) {$templateCache.put(\"components/Nav/Caret.html\",\"<div>\\n\\n    <button\\n        ng-if=\\\"navVM.state.isShowCaretLeft\\\"\\n        ng-click=\\\"navVM.selectNews(-1)\\\"\\n        class=\\\"btn--caret btn--caret--left tips--deep animate--faster\\\"\\n    >\\n        <sy-icon name=\\\"caret-left\\\"></sy-icon>\\n    </button>\\n\\n    <button\\n        ng-if=\\\"navVM.state.isShowCaretRight\\\"\\n        ng-click=\\\"navVM.selectNews(1)\\\"\\n        class=\\\"btn--caret btn--caret--right tips--deep animate--faster\\\"\\n    >\\n        <sy-icon name=\\\"caret-right\\\"></sy-icon>\\n    </button>\\n\\n</div>\");\n$templateCache.put(\"components/Nav/ChooseCountry.html\",\"<div class=\\\"btn--t--l animate--faster\\\">\\n    <ul>\\n        <li ng-repeat=\\\"country in navVM.state.countryList\\\" class=\\\"animate--faster\\\">\\n            <button\\n                class=\\\"btn--country shadow animate--faster {{ \\'btn--country--\\' + country }}\\\"\\n                ng-click=\\\"navVM.handleCountryClick(country)\\\"\\n            >\\n                {{::country}}\\n            </button>\\n        </li>\\n    </ul>\\n</div>\");\n$templateCache.put(\"components/Nav/ClickableLogo.html\",\"<button class=\\\"btn--t--r\\\" ng-click=\\\"navVM.togglehNewsType()\\\">\\n    <span class=\\\"btn--logo animate--general\\\" alt=\\\"logo\\\"></span>\\n</button>\");\n$templateCache.put(\"components/Nav/Nav.html\",\"<div>\\n\\n    <div ng-include=\\\"\\'components/Nav/Caret.html\\'\\\"></div>\\n    <div ng-include=\\\"\\'components/Nav/ClickableLogo.html\\'\\\"></div>\\n    <div ng-include=\\\"\\'components/Nav/ChooseCountry.html\\'\\\"></div>\\n\\n<div>\");\n$templateCache.put(\"components/NewsBox/FetchState.html\",\"<!-- Not Found -->\\n<div ng-if=\\\"newsVM.state.isFetchFail\\\" class=\\\"newsState--fetchFail animate--general\\\">\\n    <sy-icon name=\\\"NotFound\\\" viewbox=\\\"0 0 474 584\\\"></sy-icon>\\n</div>\\n\\n<!-- Spin -->\\n<div ng-if=\\\"newsVM.state.isFetching\\\" class=\\\"newsState--fetching animate--general\\\"></div>\\n\");\n$templateCache.put(\"components/NewsBox/Heading.html\",\"<h3>\\n    <span ng-click=\\\"newsVM.handleHeadingClick()\\\" class=\\\"cursor--pointer\\\" role=\\\"button\\\">\\n        <span ng-if=\\\"!rootVM.state.isOldNews\\\">{{newsVM.state.newsDate | date:\\'HH:00\\'}}</span>\\n        <span ng-if=\\\"rootVM.state.isOldNews\\\">{{newsVM.state.newsDate | date:\\'yyyy-MM-dd\\'}}</span>\\n    </span>\\n</h3>\");\n$templateCache.put(\"components/NewsBox/NewsBox.html\",\"<div\\n    class=\\\"newsBox animate--general shadow\\\"\\n    ng-swipe-left=\\\"newsVM.handleSwipe(1)\\\"\\n    ng-swipe-right=\\\"newsVM.handleSwipe(-1)\\\"\\n    ng-swipe-disable-mouse\\n>\\n\\n    <!-- Heading -->\\n    <div ng-include=\\\"\\'components/NewsBox/Heading.html\\'\\\"></div>\\n\\n    <!-- Content -->\\n    <div class=\\\"newsBox__content overflow--y\\\">\\n\\n        <div ng-if=\\\"newsVM.state.newsData.length > 0\\\">\\n            <div ng-include=\\\"\\'components/NewsBox/SearchBar.html\\'\\\"></div>\\n        </div>\\n\\n        <div ng-if=\\\"newsVM.state.newsData.length > 0\\\" ng-include=\\\"\\'components/NewsBox/NewsItem.html\\'\\\"></div>\\n\\n        <div ng-include=\\\"\\'components/NewsBox/FetchState.html\\'\\\"></div>\\n\\n    </div>\\n</div>\");\n$templateCache.put(\"components/NewsBox/NewsItem.html\",\"<ul ng-repeat=\\\"sourceItem in newsVM.state.newsData | filter: newsVM.state.searchText\\\">\\n    <!-- Source: Provider -->\\n    <h4>{{::sourceItem.source_name}}</h4>\\n    <!-- Source: News -->\\n    <li\\n        ng-repeat=\\\"newsItem in sourceItem.news | orderBy: \\'date\\' | filter: newsVM.state.searchText\\\"\\n        class=\\\"newsItem\\\"\\n    >\\n\\n        <!-- News: Created At -->\\n        <span class=\\\"newsItem__createdAt\\\">{{::newsItem.date | date: \\'HH:mm\\'}}</span>\\n        <!-- News: Title -->\\n        <a class=\\\"newsItem__title\\\" ng-href=\\\"{{::newsItem.url}}\\\" target=\\\"_blank\\\">{{::newsItem.title}}</a>\\n        <!-- News: Source Link -->\\n        <button ng-click=\\\"newsVM.updateQueryParam(newsItem.title)\\\" class=\\\"newsItem__link\\\">\\n            <sy-icon name=\\\"link\\\"></sy-icon>\\n        </button>\\n\\n    </li>\\n</ul>\");\n$templateCache.put(\"components/NewsBox/SearchBar.html\",\"<form class=\\\"searchBar\\\" novalidate name=\\\"searchForm\\\">\\n\\n    <input\\n        class=\\\"searchBar__input cursor--pointer animate--faster\\\"\\n        ng-class=\\\"{\\'searchBar__input--valid\\': searchForm.$valid}\\\"\\n        ng-model=\\\"newsVM.state.searchText\\\"\\n        ng-model-options=\\\"{ debounce: 300 }\\\"\\n        ng-change=\\\"newsVM.updateQueryParam(newsVM.state.searchText)\\\"\\n        type=\\\"text\\\"\\n        required\\n    >\\n\\n</form>\");\n$templateCache.put(\"components/TimeMachine/Form.html\",\"<form\\n    sy-stop-propagation\\n    ng-submit=\\\"tmVM.handleSubmit()\\\"\\n    class=\\\"timeMachine__form shadow animate--faster\\\"\\n    name=\\\"tmVM.form\\\"\\n    novalidate\\n>\\n    <div ng-if=\\\"!rootVM.state.isOldNews\\\">\\n        <input\\n            sy-auto-focus=\\\"700\\\"\\n            type=\\\"number\\\"\\n            placeholder=\\\"H\\\"\\n            ng-model=\\\"tmVM.state.timeMachine.H\\\"\\n            ng-model-options=\\\"{ debounce: 300 }\\\"\\n            ng-change=\\\"tmVM.dateValidation()\\\"\\n            class=\\\"timeMachine__input shadow--onFocus animate--faster\\\"\\n            min=\\\"1\\\"\\n            max=\\\"24\\\"\\n            required\\n        >\\n        <span>:</span>\\n        <input\\n            class=\\\"timeMachine__input shadow--onFocus animate--faster\\\"\\n            type=\\\"number\\\"\\n            placeholder=\\\"00\\\"\\n            disabled\\n        >\\n    </div>\\n    <div ng-if=\\\"rootVM.state.isOldNews\\\">\\n        <input\\n            class=\\\"timeMachine__input shadow--onFocus animate--faster\\\"\\n            ng-model=\\\"tmVM.state.timeMachine.Y\\\"\\n            ng-model-options=\\\"{ debounce: 300 }\\\"\\n            ng-change=\\\"tmVM.dateValidation()\\\"\\n            type=\\\"number\\\"\\n            placeholder=\\\"Y\\\"\\n            min=\\\"15\\\"\\n            max=\\\"16\\\"\\n            required\\n        >\\n        <span>-</span>\\n        <input\\n            class=\\\"timeMachine__input shadow--onFocus animate--faster\\\"\\n            ng-model=\\\"tmVM.state.timeMachine.M\\\"\\n            ng-model-options=\\\"{ debounce: 300 }\\\"\\n            ng-change=\\\"tmVM.dateValidation()\\\"\\n            type=\\\"number\\\"\\n            placeholder=\\\"M\\\"\\n            min=\\\"1\\\"\\n            max=\\\"12\\\"\\n            required\\n        >\\n        <span>-</span>\\n        <input\\n            class=\\\"timeMachine__input shadow--onFocus animate--faster\\\"\\n            ng-model=\\\"tmVM.state.timeMachine.D\\\"\\n            ng-model-options=\\\"{ debounce: 300 }\\\"\\n            ng-change=\\\"tmVM.dateValidation()\\\"\\n            sy-auto-focus=\\\"700\\\"\\n            type=\\\"number\\\"\\n            placeholder=\\\"D\\\"\\n            min=\\\"1\\\"\\n            max=\\\"31\\\"\\n            required\\n        >\\n    </div>\\n</form>\");\n$templateCache.put(\"components/TimeMachine/TimeMachine.html\",\"<div>\\n    <!-- Time Machine: Start Button -->\\n    <button ng-click=\\\"tmVM.toggleTimeMachine()\\\" class=\\\"btn--timeMachine tips--deep animate--faster\\\">\\n        <sy-icon name=\\\"time_machine\\\"></sy-icon>\\n    </button>\\n\\n    <!-- Time Machine: Content -->\\n    <div\\n        ng-if=\\\"tmVM.state.isShowTimeMachine\\\"\\n        ng-click=\\\"tmVM.toggleTimeMachine()\\\"\\n        class=\\\"timeMachine vertically_center animate--faster\\\"\\n    >\\n            <div class=\\\"timeMachine__content animate--general\\\">\\n                <div ng-include=\\\"\\'components/TimeMachine/Form.html\\'\\\"></div>\\n                <div ng-include=\\\"\\'components/TimeMachine/ToolBar.html\\'\\\"></div>\\n            </div>\\n    </div>\\n</div>\");\n$templateCache.put(\"components/TimeMachine/ToolBar.html\",\"<div sy-stop-propagation>\\n    <button\\n        ng-if=\\\"!tmVM.form.$invalid\\\"\\n        ng-click=\\\"tmVM.handleSubmit()\\\"\\n        class=\\\"timeMachine__btn tips\\\"\\n    >\\n        <sy-icon name=\\\"ok\\\"></sy-icon>\\n    </button>\\n    <button\\n        ng-click=\\\"tmVM.toggleTimeMachine()\\\"\\n        class=\\\"timeMachine__btn tips\\\"\\n    >\\n        <sy-icon name=\\\"cancel\\\"></sy-icon>\\n    </button>\\n</div>\");}]);","\nNavCtrl.$inject = [\"$scope\", \"$window\", \"$timeout\", \"$state\", \"$stateParams\", \"store\", \"COUNTRIES\", \"TIME\", \"TimeHelper\"];angular\n.module('ShinyaNews.components.Nav', [])\n.constant('COUNTRIES', ['BR', 'CN', 'DE', 'FR', 'HK', 'IN', 'JP', 'KR', 'RU', 'TW', 'US'])\n.directive('syNav', syNav);\n\n\nfunction syNav() {\n    return {\n        restrict    : 'E',\n        replace     : true,\n        controller  : NavCtrl,\n        controllerAs: 'navVM',\n        templateUrl : 'components/Nav/Nav.html'\n    };\n}\nfunction NavCtrl(\n    $scope, $window, $timeout,\n    $state, $stateParams, store,\n    COUNTRIES, TIME, TimeHelper\n) {\n    var vm = this;\n    this.state = {\n        isShowCaretLeft : true,\n        isShowCaretRight: true,\n        countryList     : getCountryList()\n    };\n    vm.selectNews = selectNews;\n    vm.togglehNewsType = togglehNewsType;\n    vm.handleCountryClick = handleCountryClick;\n\n    // Events\n    $scope.$on('keyDown:esc', handleKeyDownEsc);\n    $scope.$on('keyDown:leftOrRightArrow', handleKeyDownLeftOrRightArrow);\n    $scope.$on('swipe:leftOrRight', handleSwipeLeftOrRight);\n    $scope.$on('fetchNews:start', handleStartFetchNews);\n\n\n    function selectNews(step) {\n        var isOldNews = $scope.rootVM.state.isOldNews;\n        var newsDate = TimeHelper.newsDateMs(isOldNews);\n        var nextDate;\n        var nextHour;\n\n        // 屏蔽（移動端／鍵盤操作）無效的獲取新聞（滑動）\n        if (\n            step === 1 && !vm.state.isShowCaretRight ||\n            step === -1 && !vm.state.isShowCaretLeft\n        ) return;\n\n        if (isOldNews) {\n            nextDate = TimeHelper.dateFormatter(newsDate + TIME.ONE_DAY * step);\n            $state.go('news', {\n                year : nextDate.year,\n                month: nextDate.month,\n                day  : nextDate.day,\n                h    : null,\n                q    : null\n            });\n        } else {\n            nextHour = parseInt($stateParams.h || new Date().getHours(), 10) + step;\n            $state.go('news', {\n                h: nextHour,\n                q: null\n            });\n        }\n    }\n    function handleKeyDownEsc() {\n        vm.state.countryList = getCountryList();\n    }\n    function handleKeyDownLeftOrRightArrow(event, payload) {\n        vm.selectNews(payload.step);\n    }\n    function handleSwipeLeftOrRight(event, payload) {\n        vm.selectNews(payload.step);\n    }\n    function handleStartFetchNews() {\n        var isOldNews = $scope.rootVM.state.isOldNews;\n        var newsDate = TimeHelper.newsDateMs(isOldNews);\n\n        // check caret\n        if (isOldNews) {\n            // Always Show Left\n            vm.state.isShowCaretLeft = true;\n            // Before Today\n            vm.state.isShowCaretRight = newsDate + TIME.TWO_DAYS <= Date.now();\n        } else {\n            // After 0:00\n            vm.state.isShowCaretLeft = newsDate - TIME.ONE_HOUR !== TimeHelper.todayMs();\n            // Before Now Hour\n            vm.state.isShowCaretRight = newsDate + TIME.ONE_HOUR <= Date.now();\n        }\n\n        // update country\n        if (vm.state.countryList[0] !== $stateParams.country) {\n            vm.state.countryList = getCountryList();\n        }\n    }\n    function togglehNewsType() {\n        var isOldNews = $scope.rootVM.state.isOldNews;\n        var now;\n\n        if (isOldNews) {\n            // =>「新聞，」\n            now = TimeHelper.nowHourMs();\n            isOldNews = false;\n        } else {\n            // =>「舊聞。」\n            now = TimeHelper.todayMs() - TIME.ONE_DAY;\n            isOldNews = true;\n        }\n\n        now = TimeHelper.dateFormatter(now);\n\n        $state.go('news', {\n            year : now.year,\n            month: now.month,\n            day  : now.day,\n            h    : isOldNews ? null : now.hour,\n            q    : null\n        });\n    }\n    function handleCountryClick(newCountry) {\n        if (newCountry === vm.state.countryList[0]) {\n            // Select Country\n            toggleCountryList(newCountry);\n        } else {\n            // Change Country\n            $state.go('news', { country: newCountry });\n            hideCountryList(newCountry);\n        }\n\n\n        function toggleCountryList(newCountry) {\n            var activeCounty = vm.state.countryList[0];\n            var cache = [activeCounty];\n\n            if (vm.state.countryList.length === 1) {\n                // Show Country List\n                COUNTRIES.forEach(function (country) {\n                    activeCounty !== country && cache.push(country);\n                });\n                vm.state.countryList = cache;\n            } else {\n                // Hide Country List\n                hideCountryList(newCountry);\n            }\n        }\n        function hideCountryList(newCountry) {\n            // Insert newCountry to No.1\n            var preList = angular.copy(vm.state.countryList);\n            var index = preList.indexOf(newCountry);\n            preList.splice(index, 1);\n            preList.unshift(newCountry);\n            vm.state.countryList = preList;\n\n            // Hide Coutry List\n            $timeout(function () {\n                if (newCountry === preList[0]) {\n                    vm.state.countryList = [newCountry];\n                }\n            });\n        }\n    }\n    function getCountryList() {\n        return [$stateParams.country || store.get('sy-country') || 'HK'];\n    }\n}\n","/* eslint angular/document-service: 0 */\nNewsBoxCtrl.$inject = [\"$rootScope\", \"$scope\", \"$location\", \"$state\", \"$stateParams\", \"store\", \"TimeHelper\", \"FetchNews\"];\nangular\n.module('ShinyaNews.components.NewsBox', [])\n.controller('NewsBoxCtrl', NewsBoxCtrl);\n\n\nfunction NewsBoxCtrl(\n    $rootScope, $scope, $location,\n    $state, $stateParams,\n    store, TimeHelper, FetchNews\n) {\n    var vm = this;\n    vm.state = {\n        isFetching       : true,\n        isFetchFail      : false,\n        newsData         : [],\n        newsDate         : 0,\n        selectedNewsIndex: -1,\n        searchText       : $stateParams.q\n    };\n    vm.updateState = updateState;\n    vm.updateQueryParam = updateQueryParam;\n    vm.handleSwipe = handleSwipe;\n    vm.handleHeadingClick = handleHeadingClick;\n\n    // Events\n    $scope.$on('keyDown:esc', handleKeyDownEsc);\n    $scope.$on('keyDown:upOrDownArrow', handleKeyDownUpOrDownArrow);\n\n    // Fetch News\n    fetchNews();\n\n\n    function updateState(newState) {\n        angular.merge(vm.state, newState);\n    }\n    function updateQueryParam(title) {\n        vm.updateState({ searchText: title });\n        $state.go('news', {\n            q: title\n        }, { notify: false, reload: true });\n    }\n    function handleSwipe(step) {\n        $rootScope.$broadcast('swipe:leftOrRight', { step: step });\n    }\n    function handleHeadingClick() {\n        $rootScope.$broadcast('toggleTimeMachine');\n    }\n    function handleKeyDownEsc() {\n        vm.updateQueryParam('');\n        document.querySelector('.searchBar__input').blur();\n    }\n    function handleKeyDownUpOrDownArrow(event, payload) {\n        // Foucs News Item\n        var newsItemList = document.querySelectorAll('.newsItem__title');\n        var len = newsItemList.length;\n        var step;\n        var index;\n\n        if (len <= 0) return;\n\n        step = payload.step;\n        index = vm.state.selectedNewsIndex;\n\n        if (step === -1 && index > 0 && index < len) {\n            index--;\n        } else if (step === 1 && index >= -1 && index < len - 1) {\n            index++;\n        }\n\n        newsItemList[index].focus();\n        vm.updateState({ selectedNewsIndex: index });\n    }\n    function fetchNews() {\n        var country = $stateParams.country;\n        var isOldNews = !TimeHelper.isToday();\n        var date = TimeHelper.newsDateMs(isOldNews);\n\n        // Store Country\n        store.set('sy-country', country);\n\n        // Update Date\n        vm.updateState({\n            newsDate: date\n        });\n\n        // Start Fetch News\n        $rootScope.$broadcast('fetchNews:start');\n\n        FetchNews(date, country, isOldNews)\n        .then(function (newsData) {\n            vm.updateState({\n                isFetching : false,\n                isFetchFail: false,\n                newsData   : newsData\n            });\n        })\n        .catch(function () {\n            vm.updateState({\n                isFetching : false,\n                isFetchFail: true\n            });\n        })\n        .finally(function () {\n            $scope.rootVM.updateState({\n                isOldNews: isOldNews\n            });\n        });\n    }\n}\n","\nTimeMachineCtrl.$inject = [\"$scope\", \"$state\", \"$stateParams\", \"TimeHelper\"];angular\n.module('ShinyaNews.components.TimeMachine', [])\n.directive('syTimeMachine', syTimeMachine);\n\n\nfunction syTimeMachine() {\n    return {\n        restrict    : 'E',\n        replace     : true,\n        controller  : TimeMachineCtrl,\n        controllerAs: 'tmVM',\n        templateUrl : 'components/TimeMachine/TimeMachine.html'\n    };\n}\nfunction TimeMachineCtrl($scope, $state, $stateParams, TimeHelper) {\n    var vm = this;\n    vm.state = {\n        isShowTimeMachine: false,\n        timeMachine      : {\n            Y: 0,\n            M: 0,\n            D: 0,\n            H: 0\n        }\n    };\n    vm.toggleTimeMachine = toggleTimeMachine;\n    vm.handleSubmit = handleSubmit;\n    vm.dateValidation = dateValidation;\n\n    $scope.$on('keyDown:esc', handleKeyDownEsc);\n    $scope.$on('toggleTimeMachine', toggleTimeMachine);\n\n    function toggleTimeMachine() {\n        // Init Time Machine Date info\n        var newsDate = TimeHelper.newsDateMs($scope.rootVM.state.isOldNews);\n        var now = TimeHelper.dateFormatter(newsDate);\n        vm.state.timeMachine = {\n            Y: now.year % 2000,\n            M: now.month,\n            D: now.day,\n            H: now.hour\n        };\n        // Show / Hide Time Machine\n        vm.state.isShowTimeMachine = !vm.state.isShowTimeMachine;\n    }\n    function handleKeyDownEsc() {\n        vm.state.isShowTimeMachine && vm.toggleTimeMachine();\n    }\n    function handleSubmit() {\n        if ($scope.rootVM.state.isOldNews) {\n            // Only Change `Year`, `Month` and `Day`\n            $state.go('news', {\n                year : '20' + vm.state.timeMachine.Y,\n                month: vm.state.timeMachine.M,\n                day  : vm.state.timeMachine.D,\n                h    : null,\n                q    : null\n            });\n        } else {\n            // Only Change `Hour`\n            $state.go('news', { h: vm.state.timeMachine.H, q: null });\n        }\n        // Hide Time Machine\n        vm.state.isShowTimeMachine = false;\n    }\n    function dateValidation() {\n        var maxDate = Date.now();\n        var expectDate;\n\n        if ($scope.rootVM.state.isOldNews) {\n            expectDate = (\n                +new Date(\n                    '20' + vm.state.timeMachine.Y,\n                    vm.state.timeMachine.M - 1,\n                    vm.state.timeMachine.D\n                )\n            );\n        } else {\n            expectDate = (\n                +new Date(\n                    new Date().getFullYear(),\n                    new Date().getMonth(),\n                    new Date().getDate(),\n                    vm.state.timeMachine.H\n                )\n            );\n        }\n\n        vm.form && vm.form.$setValidity('maxDate', expectDate <= maxDate);\n    }\n}\n","angular.module('ShinyaNews.utils.controllers', []);\nangular.module('ShinyaNews.utils.services', []);\nangular.module('ShinyaNews.utils.directives', []);\n","\nrootCtrl.$inject = [\"$rootScope\", \"$window\"];angular\n.module('ShinyaNews.utils.controllers')\n.controller('rootCtrl', rootCtrl);\n\n\nfunction rootCtrl($rootScope, $window) {\n    var vm = this;\n    vm.state = {\n        isOldNews: false\n    };\n    vm.updateState = updateState;\n\n    // Events\n    angular.element($window).on('keydown', handleKeyDown);\n\n\n    function updateState(newState) {\n        angular.merge(vm.state, newState);\n    }\n    function handleKeyDown(e) {\n        var keyCode = e.keyCode;\n        var target = e.target.tagName.toLowerCase();\n\n        switch (keyCode) {\n            case 27: // esc\n                $rootScope.$broadcast('keyDown:esc');\n                break;\n            case 37: // ←\n            case 39: // →\n                if (target === 'input') return;\n                $rootScope.$broadcast('keyDown:leftOrRightArrow', {\n                    step: keyCode === 37 ? -1 : 1\n                });\n                break;\n            case 38: // ↑\n            case 40: // ↓\n                if (target === 'input') return;\n                $rootScope.$broadcast('keyDown:upOrDownArrow', { step: keyCode === 38 ? -1 : 1 });\n                break;\n            default:\n                break;\n        }\n    }\n}\n","\nautoFocus.$inject = [\"$timeout\"];angular\n.module('ShinyaNews.utils.directives')\n.directive('syAutoFocus', autoFocus);\n\n\nfunction autoFocus($timeout) {\n    return {\n        restrict: 'A',\n        scope   : {},\n        link    : function ($scope, $elem, $attr) {\n            var timeout = parseInt($attr.syAutoFocus, 10) || 0;\n\n            $timeout(function () {\n                $elem[0].focus();\n            }, timeout);\n        }\n    };\n}\n","angular\n.module('ShinyaNews.utils.directives')\n.directive('syIcon', syIcon);\n\n\nfunction syIcon() {\n    return {\n        restrict: 'E',\n        replace : true,\n        template: function ($elem, $attr) {\n            var viewBox = $attr.viewbox || '0 0 100 100';\n            var name = $attr.name;\n\n            return [\n                '<svg viewBox=\"' + viewBox + '\">',\n                '<use xlink:href=\"/public/img/icon-sprites.svg#' + name + '\"></use>',\n                '</svg>'\n            ].join('');\n        }\n    };\n}\n","angular\n.module('ShinyaNews.utils.directives')\n.directive('syStopPropagation', stopPropagation);\n\n\nfunction stopPropagation() {\n    return {\n        restrict: 'A',\n        link    : function ($scope, $elem, $attr) {\n            $elem.on('click', stopPropagation);\n            $elem.on('touchstart', stopPropagation);\n\n            function stopPropagation(e) {\n                e.stopPropagation();\n            }\n        }\n    };\n}\n","\nNewsStore.$inject = [\"$window\", \"store\", \"STORE_PREFIX\", \"TimeHelper\", \"TIME\"];\nOldNewsStore.$inject = [\"$cacheFactory\"];\nFetchNews.$inject = [\"$q\", \"$http\", \"NewsStore\", \"OldNewsStore\"];angular\n.module('ShinyaNews.utils.services')\n.constant('STORE_PREFIX', 'sy-news-')\n.factory('NewsStore', NewsStore)\n.factory('OldNewsStore', OldNewsStore)\n.factory('FetchNews', FetchNews)\n.run([\"store\", \"STORE_PREFIX\", \"NewsStore\", function (store, STORE_PREFIX, NewsStore) {\n    // Clear Expired News\n    store.get(STORE_PREFIX + 'expiration-date') < Date.now() && NewsStore.removeAll();\n}]);\n\n\nfunction NewsStore($window, store, STORE_PREFIX, TimeHelper, TIME) {\n    return {\n        get      : get,\n        set      : set,\n        removeAll: removeAll\n    };\n\n\n    // Get News\n    function get(newsID) {\n        return store.get(STORE_PREFIX + newsID);\n    }\n    // Store News and Expiration Date\n    function set(newsID, news) {\n        store.set(STORE_PREFIX + newsID, news);\n        store.set(STORE_PREFIX + 'expiration-date', TimeHelper.todayMs() + TIME.ONE_DAY);\n    }\n    // Remove all News\n    function removeAll() {\n        var ls = $window.localStorage;\n        var reg = new RegExp('^' + STORE_PREFIX);\n        var i;\n        var j;\n        var len;\n\n        for (i = 0, j = 0, len = localStorage.length; i < len; i++) {\n            reg.test(ls.key(j))\n                ? store.remove(ls.key(j))\n            : j++;\n        }\n    }\n}\nfunction OldNewsStore($cacheFactory) {\n    return $cacheFactory('OldNewsStore');\n}\nfunction FetchNews($q, $http, NewsStore, OldNewsStore) {\n    return function (date, country, isOldNews) {\n        var newsId = date + country;\n        var localNewsData = isOldNews ? OldNewsStore.get(newsId) : NewsStore.get(newsId);\n\n        return $q(function (resolve, reject) {\n            if (!date || !country) {\n                reject('invalid params');\n                return;\n            }\n\n            if (localNewsData) {\n                // Fetch From Local\n                resolve(localNewsData);\n            } else {\n                // Fetch From Remote\n                $http\n                .get('/news/' + country + '/' + date + '/' + (isOldNews ? 24 : 1))\n                .success(function (data) {\n                    if (data.msg) {\n                        if (isOldNews) {\n                            OldNewsStore.put(newsId, data.msg);\n                        } else {\n                            NewsStore.set(newsId, data.msg);\n                        }\n                    }\n\n                    resolve(data.msg);\n                })\n                .error(function () {\n                    reject();\n                });\n            }\n        });\n    };\n}\n","\nTimeHelper.$inject = [\"$stateParams\"];angular\n.module('ShinyaNews.utils.services')\n.constant('TIME', {\n    ONE_HOUR: 1000 * 60 * 60,\n    ONE_DAY : 1000 * 60 * 60 * 24,\n    TWO_DAYS: 1000 * 60 * 60 * 48\n})\n.factory('TimeHelper', TimeHelper);\n\n\nfunction TimeHelper($stateParams) {\n    return {\n        nowHourMs    : nowHourMs,\n        todayMs      : todayMs,\n        newsDateMs   : newsDateMs,\n        isToday      : isToday,\n        dateFormatter: dateFormatter\n    };\n\n\n    function nowHourMs() {\n        var date = new Date();\n        return +new Date(\n            date.getFullYear(),\n            date.getMonth(),\n            date.getDate(),\n            date.getHours()\n        );\n    }\n    function todayMs() {\n        var date = new Date();\n        return +new Date(\n            date.getFullYear(),\n            date.getMonth(),\n            date.getDate()\n        );\n    }\n    function newsDateMs(isOldNews) {\n        var year  = $stateParams.year;\n        var month = $stateParams.month;\n        var day   = $stateParams.day;\n        var hour  = $stateParams.h;\n\n        return +new Date(year, month - 1, day, isOldNews ? null : hour);\n    }\n    function isToday() {\n        var year  = parseInt($stateParams.year, 10);\n        var month = parseInt($stateParams.month, 10);\n        var day   = parseInt($stateParams.day, 10);\n        var now   = dateFormatter(Date.now());\n\n        return year === now.year && month === now.month && day === now.day;\n    }\n    function dateFormatter(dateMs) {\n        var date = new Date(dateMs);\n        return {\n            year : date.getFullYear(),\n            month: date.getMonth() + 1,\n            day  : date.getDate(),\n            hour : date.getHours()\n        };\n    }\n}\n","/* eslint no-param-reassign: 0 */\nstore.$inject = [\"$window\"];\nangular\n.module('ShinyaNews.utils.services')\n.factory('store', store);\n\n\n/**\n * @name store\n * @desc LocalStorage that support Object and Array\n *\n */\nfunction store($window) {\n    return {\n        get   : get,\n        set   : set,\n        remove: remove\n    };\n\n\n    function get(key) {\n        return _parseJSON($window.localStorage.getItem(key));\n    }\n    function set(key, value) {\n        return $window.localStorage.setItem(key, angular.toJson(value));\n    }\n    function remove(key) {\n        $window.localStorage.removeItem(key);\n    }\n    function _parseJSON(data) {\n        try {\n            data = angular.fromJson(data);\n        } catch (e) {\n            // Empty\n        } finally {\n            return data;\n        }\n    }\n}\n"],"sourceRoot":"/source/"}