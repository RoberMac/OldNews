{"version":3,"sources":["entry.js","templates.js","Nav/Nav.js","NewsBox/NewsBox.js","TimeMachine/TimeMachine.js","utils.js","controllers/rootCtrl.js","directives/syAutofocus.js","directives/syIcon.js","directives/syStopPropagation.js","services/FetchNews.js","services/TimeHelper.js","services/store.js"],"names":["config","$locationProvider","$stateProvider","$urlRouterProvider","otherwise","now","Date","year","getFullYear","month","getMonth","day","getDate","h","getHours","country","JSON","parse","window","localStorage","getItem","html5Mode","state","url","join","templateUrl","controller","controllerAs","$inject","angular","module","run","$templateCache","put","syNav","restrict","replace","NavCtrl","$scope","$window","$timeout","$state","$stateParams","store","COUNTRIES","TIME","TimeHelper","selectNews","step","isOldNews","rootVM","newsDate","newsDateMs","vm","isShowCaretRight","isShowCaretLeft","nextDate","dateFormatter","ONE_DAY","go","q","nextHour","parseInt","handleKeyDownLeftOrRightArrow","event","payload","checkCaret","TWO_DAYS","ONE_HOUR","todayMs","togglehNewsType","nowHourMs","hour","handleCountryClick","newCountry","toggleCountryList","activeCounty","countryList","cache","length","forEach","push","hideCountryList","preList","copy","index","indexOf","splice","unshift","this","get","$on","constant","directive","NewsBoxCtrl","$rootScope","$location","FetchNews","updateState","newState","merge","updateQueryParam","title","searchText","notify","reload","handleSwipe","$broadcast","handleHeadingClick","handleKeyDownEsc","document","querySelector","blur","handleKeyDownUpOrDownArrow","newsItemList","querySelectorAll","len","selectedNewsIndex","focus","fetchNews","isToday","date","set","then","newsData","isFetching","isFetchFail","$watch","newVal","oldVal","syTimeMachine","TimeMachineCtrl","toggleTimeMachine","timeMachine","Y","M","D","H","isShowTimeMachine","handleSubmit","formValidation","expectDate","maxDate","form","$setValidity","$watchCollection","rootCtrl","handleKeyDown","e","keyCode","target","tagName","toLowerCase","element","on","autoFocus","scope","link","$elem","$attr","timeout","syAutoFocus","syIcon","template","viewBox","viewbox","name","stopPropagation","NewsStore","STORE_PREFIX","newsID","news","removeAll","ls","reg","RegExp","i","j","test","key","remove","OldNewsStore","$cacheFactory","$q","$http","newsId","localNewsData","resolve","reject","post","selectDate","selectCountry","isAllDay","success","data","status","headers","msg","error","factory","dateMs","_parseJSON","value","setItem","stringify","removeItem"],"mappings":"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","file":"app.js","sourcesContent":["\nconfig.$inject = [\"$locationProvider\", \"$stateProvider\", \"$urlRouterProvider\"];angular\n.module('ShinyaNews', [\n    // Vendors\n    'ngTouch',\n    'ngAnimate',\n    'ui.router',\n    // App\n    'ShinyaNews.utils.controllers',\n    'ShinyaNews.utils.services',\n    'ShinyaNews.utils.directives',\n    'ShinyaNews.components.NewsBox',\n    'ShinyaNews.components.TimeMachine',\n    'ShinyaNews.components.Nav',\n    'ShinyaNews.templates',\n])\n.config(config);\n\n\nfunction config($locationProvider, $stateProvider, $urlRouterProvider) {\n\n    $urlRouterProvider.otherwise(function() {\n        var now     = new Date();\n        var year    = now.getFullYear();\n        var month   = now.getMonth() + 1;\n        var day     = now.getDate();\n        var h       = now.getHours();\n        var country = JSON.parse(window.localStorage.getItem('sy-country')) || \"HK\";\n\n        return country + '/' + year + '/' + month + '/' + day + '?h=' + h;\n    });\n\n    $locationProvider.html5Mode(true);\n\n    $stateProvider\n    .state('news', {\n        url: [\n            '/{country:BR|CN|DE|FR|HK|IN|JP|KR|RU|TW|US}', // Country\n            '/{year:201[5-6]}', // Year\n            '/{month:0?[1-9]|1[0-2]}', // Month\n            '/{day:0?[0-9]|[12][0-9]|3[0-1]}', // Day\n            '?h', // Hour\n            '&q', // Search\n        ].join(''),\n        templateUrl: 'components/NewsBox/NewsBox.html',\n        controller: 'NewsBoxCtrl',\n        controllerAs: 'newsVM'\n    })\n}","angular.module(\"ShinyaNews.templates\", []).run([\"$templateCache\", function($templateCache) {$templateCache.put(\"components/Nav/Caret.html\",\"<div>\\n\\n    <button\\n        ng-if=\\\"navVM.state.isShowCaretLeft\\\"\\n        ng-click=\\\"navVM.selectNews(-1)\\\"\\n        class=\\\"btn--caret btn--caret--left tips--deep animate--faster\\\"\\n    >\\n        <sy-icon name=\\\"caret-left\\\"></sy-icon>\\n    </button>\\n\\n    <button\\n        ng-if=\\\"navVM.state.isShowCaretRight\\\"\\n        ng-click=\\\"navVM.selectNews(1)\\\"\\n        class=\\\"btn--caret btn--caret--right tips--deep animate--faster\\\"\\n    >\\n        <sy-icon name=\\\"caret-right\\\"></sy-icon>\\n    </button>\\n\\n</div>\");\n$templateCache.put(\"components/Nav/ChooseCountry.html\",\"<div class=\\\"btn--t--l animate--faster\\\">\\n    <ul>\\n        <li ng-repeat=\\\"country in navVM.state.countryList\\\" class=\\\"animate--faster\\\">\\n            <button\\n                class=\\\"btn--country shadow animate--faster {{ \\'btn--country--\\' + country }}\\\"\\n                ng-click=\\\"navVM.handleCountryClick(country)\\\"\\n            >\\n                {{::country}}\\n            </button>\\n        </li>\\n    </ul>\\n</div>\");\n$templateCache.put(\"components/Nav/ClickableLogo.html\",\"<button class=\\\"btn--t--r\\\" ng-click=\\\"navVM.togglehNewsType()\\\">\\n    <span class=\\\"btn--logo animate--general\\\" alt=\\\"logo\\\"></span>\\n</button>\");\n$templateCache.put(\"components/Nav/Nav.html\",\"<div>\\n\\n    <div ng-include=\\\"\\'components/Nav/Caret.html\\'\\\"></div>\\n    <div ng-include=\\\"\\'components/Nav/ClickableLogo.html\\'\\\"></div>\\n    <div ng-include=\\\"\\'components/Nav/ChooseCountry.html\\'\\\"></div>\\n\\n<div>\");\n$templateCache.put(\"components/NewsBox/FetchState.html\",\"<!-- Not Found -->\\n<div ng-if=\\\"newsVM.state.isFetchFail\\\" class=\\\"newsState--fetchFail animate--general\\\">\\n    <sy-icon name=\\\"NotFound\\\" viewbox=\\\"0 0 474 584\\\"></sy-icon>\\n</div>\\n\\n<!-- Spin -->\\n<div ng-if=\\\"newsVM.state.isFetching\\\" class=\\\"newsState--fetching animate--general\\\"></div>\\n\");\n$templateCache.put(\"components/NewsBox/Heading.html\",\"<h3>\\n    <span ng-click=\\\"newsVM.handleHeadingClick()\\\" class=\\\"cursor--pointer\\\" role=\\\"button\\\">\\n        <span ng-if=\\\"!rootVM.state.isOldNews\\\">{{newsVM.state.newsDate | date:\\'HH:00\\'}}</span>\\n        <span ng-if=\\\"rootVM.state.isOldNews\\\">{{newsVM.state.newsDate | date:\\'yyyy-MM-dd\\'}}</span>\\n    </span>\\n</h3>\");\n$templateCache.put(\"components/NewsBox/NewsBox.html\",\"<div\\n    class=\\\"newsBox animate--general shadow\\\"\\n    ng-swipe-left=\\\"newsVM.handleSwipe(1)\\\"\\n    ng-swipe-right=\\\"newsVM.handleSwipe(-1)\\\"\\n    ng-swipe-disable-mouse\\n>\\n\\n    <!-- Heading -->\\n    <div ng-include=\\\"\\'components/NewsBox/Heading.html\\'\\\"></div>\\n\\n    <!-- Content -->\\n    <div class=\\\"newsBox__content overflow--y\\\">\\n\\n        <div ng-if=\\\"newsVM.state.newsData.length > 0\\\">\\n            <div ng-include=\\\"\\'components/NewsBox/SearchBar.html\\'\\\"></div>\\n        </div>\\n\\n        <div ng-if=\\\"newsVM.state.newsData.length > 0\\\" ng-include=\\\"\\'components/NewsBox/NewsItem.html\\'\\\"></div>\\n\\n        <div ng-include=\\\"\\'components/NewsBox/FetchState.html\\'\\\"></div>\\n\\n    </div>\\n</div>\");\n$templateCache.put(\"components/NewsBox/NewsItem.html\",\"<ul ng-repeat=\\\"sourceItem in newsVM.state.newsData | filter: newsVM.state.searchText\\\">\\n    <!-- Source: Provider -->\\n    <h4>{{::sourceItem.source_name}}</h4>\\n    <!-- Source: News -->\\n    <li\\n        ng-repeat=\\\"newsItem in sourceItem.news | orderBy: \\'date\\' | filter: newsVM.state.searchText\\\"\\n        class=\\\"newsItem\\\"\\n    >\\n\\n        <!-- News: Created At -->\\n        <span class=\\\"newsItem__createdAt\\\">{{::newsItem.date | date: \\'HH:mm\\'}}</span>\\n        <!-- News: Title -->\\n        <a class=\\\"newsItem__title\\\" ng-href=\\\"{{::newsItem.url}}\\\" target=\\\"_blank\\\">{{::newsItem.title}}</a>\\n        <!-- News: Source Link -->\\n        <button ng-click=\\\"newsVM.updateQueryParam(newsItem.title)\\\" class=\\\"newsItem__link\\\">\\n            <sy-icon name=\\\"link\\\"></sy-icon>\\n        </button>\\n\\n    </li>\\n</ul>\");\n$templateCache.put(\"components/NewsBox/SearchBar.html\",\"<form class=\\\"searchBar\\\" novalidate name=\\\"searchForm\\\">\\n\\n    <input\\n        class=\\\"searchBar__input cursor--pointer animate--faster\\\"\\n        ng-class=\\\"{\\'searchBar__input--valid\\': searchForm.$valid}\\\"\\n        ng-model=\\\"newsVM.state.searchText\\\"\\n        ng-model-options=\\\"{ debounce: 300 }\\\"\\n        type=\\\"text\\\"\\n        required\\n    >\\n\\n</form>\");\n$templateCache.put(\"components/TimeMachine/Form.html\",\"<form\\n    sy-stop-propagation\\n    ng-submit=\\\"tmVM.handleSubmit()\\\"\\n    class=\\\"timeMachine__form shadow animate--faster\\\"\\n    name=\\\"tmVM.form\\\"\\n    novalidate\\n>\\n    <div ng-if=\\\"!rootVM.state.isOldNews\\\">\\n        <input\\n            sy-auto-focus=\\\"700\\\"\\n            type=\\\"number\\\"\\n            placeholder=\\\"H\\\"\\n            ng-model=\\\"tmVM.state.timeMachine.H\\\"\\n            ng-model-options=\\\"{ debounce: 300 }\\\"\\n            class=\\\"timeMachine__input shadow--onFocus animate--faster\\\"\\n            min=\\\"1\\\"\\n            max=\\\"24\\\"\\n            required\\n        >\\n        <span>:</span>\\n        <input\\n            class=\\\"timeMachine__input shadow--onFocus animate--faster\\\"\\n            type=\\\"number\\\"\\n            placeholder=\\\"00\\\"\\n            disabled\\n        >\\n    </div>\\n    <div ng-if=\\\"rootVM.state.isOldNews\\\">\\n        <input\\n            class=\\\"timeMachine__input shadow--onFocus animate--faster\\\"\\n            ng-model=\\\"tmVM.state.timeMachine.Y\\\"\\n            ng-model-options=\\\"{ debounce: 300 }\\\"\\n            type=\\\"number\\\"\\n            placeholder=\\\"Y\\\"\\n            min=\\\"15\\\"\\n            max=\\\"16\\\"\\n            required\\n        >\\n        <span>-</span>\\n        <input\\n            class=\\\"timeMachine__input shadow--onFocus animate--faster\\\"\\n            ng-model=\\\"tmVM.state.timeMachine.M\\\"\\n            ng-model-options=\\\"{ debounce: 300 }\\\"\\n            type=\\\"number\\\"\\n            placeholder=\\\"M\\\"\\n            min=\\\"1\\\"\\n            max=\\\"12\\\"\\n            required\\n        >\\n        <span>-</span>\\n        <input\\n            class=\\\"timeMachine__input shadow--onFocus animate--faster\\\"\\n            ng-model=\\\"tmVM.state.timeMachine.D\\\"\\n            ng-model-options=\\\"{ debounce: 300 }\\\"\\n            sy-auto-focus=\\\"700\\\"\\n            type=\\\"number\\\"\\n            placeholder=\\\"D\\\"\\n            min=\\\"1\\\"\\n            max=\\\"31\\\"\\n            required\\n        >\\n    </div>\\n</form>\");\n$templateCache.put(\"components/TimeMachine/TimeMachine.html\",\"<div>\\n    <!-- Time Machine: Start Button -->\\n    <button ng-click=\\\"tmVM.toggleTimeMachine()\\\" class=\\\"btn--timeMachine tips--deep animate--faster\\\">\\n        <sy-icon name=\\\"time_machine\\\"></sy-icon>\\n    </button>\\n\\n    <!-- Time Machine: Content -->\\n    <div\\n        ng-if=\\\"tmVM.state.isShowTimeMachine\\\"\\n        ng-click=\\\"tmVM.toggleTimeMachine()\\\"\\n        class=\\\"timeMachine vertically_center animate--faster\\\"\\n    >\\n            <div class=\\\"timeMachine__content animate--general\\\">\\n                <div ng-include=\\\"\\'components/TimeMachine/Form.html\\'\\\"></div>\\n                <div ng-include=\\\"\\'components/TimeMachine/ToolBar.html\\'\\\"></div>\\n            </div>\\n    </div>\\n</div>\");\n$templateCache.put(\"components/TimeMachine/ToolBar.html\",\"<div sy-stop-propagation>\\n    <button\\n        ng-if=\\\"!tmVM.form.$invalid\\\"\\n        ng-click=\\\"tmVM.handleSubmit()\\\"\\n        class=\\\"timeMachine__btn tips\\\"\\n    >\\n        <sy-icon name=\\\"ok\\\"></sy-icon>\\n    </button>\\n    <button\\n        ng-click=\\\"tmVM.toggleTimeMachine()\\\"\\n        class=\\\"timeMachine__btn tips\\\"\\n    >\\n        <sy-icon name=\\\"cancel\\\"></sy-icon>\\n    </button>\\n</div>\");}]);","\nNavCtrl.$inject = [\"$scope\", \"$window\", \"$timeout\", \"$state\", \"$stateParams\", \"store\", \"COUNTRIES\", \"TIME\", \"TimeHelper\"];angular\n.module('ShinyaNews.components.Nav', [])\n.constant('COUNTRIES', ['HK', 'CN', 'JP', 'TW', 'US', 'BR', 'IN', 'KR', 'RU', 'DE', 'FR'])\n.directive('syNav', syNav);\n\n\nfunction syNav(){\n    return {\n        restrict: 'E',\n        replace: true,\n        controller: NavCtrl,\n        controllerAs: 'navVM',\n        templateUrl: 'components/Nav/Nav.html'\n    };\n}\nfunction NavCtrl(\n    $scope, $window, $timeout,\n    $state, $stateParams, store,\n    COUNTRIES, TIME, TimeHelper\n){\n\n    var vm = this;\n    this.state = {\n        isShowCaretLeft: true,\n        isShowCaretRight: true,\n        countryList: [store.get('sy-country') || 'HK']\n    };\n    vm.selectNews = selectNews;\n    vm.togglehNewsType = togglehNewsType;\n    vm.handleCountryClick = handleCountryClick;\n\n    // Events\n    $scope.$on('keyDown:leftOrRightArrow', handleKeyDownLeftOrRightArrow)\n    $scope.$on('fetchNews:start', checkCaret)\n\n\n    function selectNews(step) {\n        var isOldNews = $scope.rootVM.state.isOldNews;\n        var newsDate = TimeHelper.newsDateMs(isOldNews);\n\n        // 屏蔽（移動端／鍵盤操作）無效的獲取新聞（滑動）\n        if (step === 1 && !vm.state.isShowCaretRight || step === -1 && !vm.state.isShowCaretLeft) return;\n\n        switch (isOldNews) {\n            case true:\n                var nextDate = TimeHelper.dateFormatter(newsDate + TIME.ONE_DAY * step);\n                $state.go('news', {\n                    year : nextDate.year,\n                    month: nextDate.month,\n                    day  : nextDate.day,\n                    h    : null,\n                    q    : null\n                });\n                break;\n            case false:\n                var nextHour = parseInt($stateParams.h || new Date().getHours()) + step;\n                $state.go('news', {\n                    h: nextHour,\n                    q: null\n                })\n                break;\n        }\n    }\n    function handleKeyDownLeftOrRightArrow(event, payload) {\n        vm.selectNews(payload.step)\n    }\n    function checkCaret() {\n        var isOldNews = $scope.rootVM.state.isOldNews;\n        var newsDate = TimeHelper.newsDateMs(isOldNews);\n\n        switch (isOldNews) {\n            case true:\n                // Always Show Left\n                vm.state.isShowCaretLeft = true;\n                // Before Today\n                vm.state.isShowCaretRight = newsDate + TIME.TWO_DAYS <= Date.now();\n                break;\n            case false:\n                // After 0:00\n                vm.state.isShowCaretLeft = newsDate - TIME.ONE_HOUR !== TimeHelper.todayMs();\n                // Before Now Hour\n                vm.state.isShowCaretRight = newsDate + TIME.ONE_HOUR <= Date.now();\n                break;\n        }\n    }\n    function togglehNewsType() {\n        var isOldNews = $scope.rootVM.state.isOldNews;\n        var now;\n        switch (isOldNews){\n            // =>「新聞，」\n            case true:\n                now = TimeHelper.nowHourMs();\n                isOldNews = false\n                break;\n            // =>「舊聞。」\n            case false:\n                now = TimeHelper.todayMs() - TIME.ONE_DAY;\n                isOldNews = true\n                break;\n        }\n        now = TimeHelper.dateFormatter(now);\n\n        $state.go('news', {\n            year : now.year,\n            month: now.month,\n            day  : now.day,\n            h    : isOldNews ? null : now.hour,\n            q    : null\n        });\n    }\n    function handleCountryClick(newCountry) {\n        switch (newCountry === vm.state.countryList[0]) {\n            // Select Country\n            case true:\n                toggleCountryList(newCountry)\n                break;\n            // Change Country\n            case false:\n                $state.go('news', { country: newCountry })\n                hideCountryList(newCountry)\n                break;\n        }\n\n\n        function toggleCountryList(newCountry) {\n            var activeCounty = vm.state.countryList[0];\n            var cache = [activeCounty];\n\n            switch (vm.state.countryList.length === 1) {\n                // Show Country List\n                case true:\n                    COUNTRIES.forEach(function(country) {\n                        activeCounty !== country && cache.push(country);\n                    })\n                    vm.state.countryList = cache;\n                    break;\n                // Hide Country List\n                case false:\n                    hideCountryList(newCountry)\n                    break;\n            }\n        }\n        function hideCountryList(newCountry) {\n            // Insert newCountry to No.1\n            var preList = angular.copy(vm.state.countryList);\n            var index = preList.indexOf(newCountry);\n            preList.splice(index, 1)\n            preList.unshift(newCountry)\n            vm.state.countryList = preList;\n\n            // Hide Coutry List\n            $timeout(function (){\n                if (newCountry === preList[0]){\n                    vm.state.countryList = [newCountry]\n                }\n            })\n        }\n    }\n}","\nNewsBoxCtrl.$inject = [\"$rootScope\", \"$scope\", \"$location\", \"$state\", \"$stateParams\", \"store\", \"TimeHelper\", \"FetchNews\"];angular\n.module('ShinyaNews.components.NewsBox', [])\n.controller('NewsBoxCtrl', NewsBoxCtrl);\n\n\nfunction NewsBoxCtrl(\n    $rootScope, $scope, $location,\n    $state, $stateParams,\n    store, TimeHelper, FetchNews\n){\n\n    var vm = this;\n    vm.state = {\n        isFetching: true,\n        isFetchFail: false,\n        newsData: [],\n        newsDate: 0,\n        selectedNewsIndex: -1,\n        searchText: $stateParams.q,\n    };\n    vm.updateState = updateState;\n    vm.updateQueryParam = updateQueryParam;\n    vm.handleSwipe = handleSwipe;\n    vm.handleHeadingClick = handleHeadingClick;\n\n    // Events\n    $scope.$on('keyDown:esc', handleKeyDownEsc)\n    $scope.$on('keyDown:upOrDownArrow', handleKeyDownUpOrDownArrow)\n    $scope.$watch('newsVM.state.searchText', function(newVal, oldVal) {\n        if (newVal !== oldVal){\n            vm.updateQueryParam(newVal)\n        }\n    })\n\n    // Fetch News\n    fetchNews()\n\n\n    function updateState(newState) {\n        angular.merge(vm.state, newState)\n    }\n    function updateQueryParam(title) {\n        vm.updateState({ searchText: title })\n        $state.go('news', {\n            q: title\n        }, { notify: false, reload: true })\n    }\n    function handleSwipe(step){\n        $rootScope.$broadcast('selectNews', { step: step })\n    }\n    function handleHeadingClick() {\n        $rootScope.$broadcast('toggleTimeMachine')\n    }\n    function handleKeyDownEsc() {\n        vm.updateQueryParam('')\n        document.querySelector('.searchBar__input').blur()\n    }\n    function handleKeyDownUpOrDownArrow(event, payload) {\n        // Foucs News Item\n        var newsItemList = document.querySelectorAll('.newsItem__title');\n        var len = newsItemList.length;\n\n        if (len <= 0) return;\n\n        var step = payload.step;\n        var index = vm.state.selectedNewsIndex;\n\n        if (step === -1 && index > 0 && index < len) {\n            index--;\n        }\n        else if (step === 1 && index >= -1 && index < len - 1) {\n            index++;\n        }\n\n        newsItemList[index].focus()\n        vm.updateState({ selectedNewsIndex: index })\n    }\n    function fetchNews() {\n        var country = $stateParams.country;\n        var isOldNews = !TimeHelper.isToday();\n        var date = TimeHelper.newsDateMs(isOldNews);\n\n        // Store Country\n        store.set('sy-country', country)\n\n        // Update Date\n        vm.updateState({\n            newsDate: date\n        })\n\n        // Start Fetch News\n        $rootScope.$broadcast('fetchNews:start')\n\n        FetchNews(date, country, isOldNews)\n        .then(function(newsData) {\n            vm.updateState({\n                isFetching: false,\n                isFetchFail: false,\n                newsData: newsData\n            })\n        })\n        .catch(function() {\n            vm.updateState({\n                isFetching: false,\n                isFetchFail: true\n            })\n        })\n        .finally(function() {\n            $scope.rootVM.updateState({\n                isOldNews: isOldNews\n            })\n        })\n    }\n}","\nTimeMachineCtrl.$inject = [\"$scope\", \"$state\", \"$stateParams\", \"TimeHelper\"];angular\n.module('ShinyaNews.components.TimeMachine', [])\n.directive('syTimeMachine', syTimeMachine);\n\n\nfunction syTimeMachine() {\n    return {\n        restrict: 'E',\n        replace: true,\n        controller: TimeMachineCtrl,\n        controllerAs: 'tmVM',\n        templateUrl: 'components/TimeMachine/TimeMachine.html'\n    }\n}\nfunction TimeMachineCtrl($scope, $state, $stateParams, TimeHelper) {\n    var vm = this;\n    vm.state = {\n        isShowTimeMachine: false,\n        timeMachine: {\n            Y: 0,\n            M: 0,\n            D: 0,\n            H: 0\n        }\n    };\n    vm.toggleTimeMachine = toggleTimeMachine;\n    vm.handleSubmit = handleSubmit;\n\n    $scope.$on('keyDown:esc', handleKeyDownEsc)\n    $scope.$on('toggleTimeMachine', toggleTimeMachine)\n    $scope.$watchCollection('tmVM.state.timeMachine', formValidation)\n\n\n    function toggleTimeMachine() {\n        // Init Time Machine Date info\n        var newsDate = TimeHelper.newsDateMs($scope.rootVM.state.isOldNews);\n        var now = TimeHelper.dateFormatter(newsDate);\n        vm.state.timeMachine = {\n            Y: now.year % 2000,\n            M: now.month,\n            D: now.day,\n            H: now.hour\n        };\n        // Show / Hide Time Machine\n        vm.state.isShowTimeMachine = !vm.state.isShowTimeMachine\n    }\n    function handleKeyDownEsc() {\n        vm.state.isShowTimeMachine && vm.toggleTimeMachine()\n    }\n    function handleSubmit() {\n        switch ($scope.rootVM.state.isOldNews) {\n            // Only Change `Year`, `Month` and `Day`\n            case true:\n                $state.go('news', {\n                    year : '20' + vm.state.timeMachine.Y,\n                    month: vm.state.timeMachine.M,\n                    day  : vm.state.timeMachine.D,\n                    h    : null,\n                    q    : null\n                })\n                break;\n            // Only Change `Hour`\n            case false:\n                var h = vm.state.timeMachine.H;\n\n                $state.go('news', { h: h, q: null })\n                break;\n        }\n        // Hide Time Machine\n        vm.state.isShowTimeMachine = false\n    }\n    function formValidation(newVal, oldVal) {\n        var maxDate = Date.now()\n        var expectDate;\n\n        switch ($scope.rootVM.state.isOldNews) {\n            case true:\n                expectDate = (\n                    Date.parse(new Date(\n                        '20' + vm.state.timeMachine.Y,\n                        vm.state.timeMachine.M - 1,\n                        vm.state.timeMachine.D\n                    ))\n                );\n                break;\n            case false:\n                expectDate = (\n                    Date.parse(new Date(\n                        new Date().getFullYear(),\n                        new Date().getMonth(),\n                        new Date().getDate(),\n                        vm.state.timeMachine.H\n                    ))\n                );\n                break;\n        }\n\n        vm.form && vm.form.$setValidity('maxDate', expectDate <= maxDate)\n    }\n}","angular.module('ShinyaNews.utils.controllers', []);\nangular.module('ShinyaNews.utils.services', []);\nangular.module('ShinyaNews.utils.directives', []);","\nrootCtrl.$inject = [\"$rootScope\", \"$window\"];angular\n.module('ShinyaNews.utils.controllers')\n.controller('rootCtrl', rootCtrl);\n\n\nfunction rootCtrl($rootScope, $window){\n    var vm = this;\n    vm.state = {\n        isOldNews: false\n    };\n    vm.updateState = updateState;\n\n    // Events\n    angular.element($window).on('keydown', handleKeyDown)\n\n\n    function updateState(newState) {\n        angular.merge(vm.state, newState)\n    }\n    function handleKeyDown(e) {\n        var keyCode = e.keyCode;\n        var target = e.target.tagName.toLowerCase();\n\n        switch (keyCode) {\n            case 27: // esc\n                $rootScope.$broadcast('keyDown:esc')\n                break;\n            case 37: // ←\n            case 39: // →\n                if (target === 'input') return;\n                $rootScope.$broadcast('keyDown:leftOrRightArrow', { step: keyCode === 37 ? -1 : 1 })\n                break;\n            case 38: // ↑\n            case 40: // ↓\n                if (target === 'input') return;\n                $rootScope.$broadcast('keyDown:upOrDownArrow', { step: keyCode === 38 ? -1 : 1 })\n                break;\n        }\n    }\n}","\nautoFocus.$inject = [\"$timeout\"];angular\n.module('ShinyaNews.utils.directives')\n.directive('syAutoFocus', autoFocus);\n\n\nfunction autoFocus($timeout) {\n    return {\n        restrict: 'A',\n        scope: {},\n        link: function($scope, $elem, $attr) {\n            var timeout = ~~$attr.syAutoFocus || 0;\n\n            $timeout(function (){\n                $elem[0].focus()\n            }, timeout)\n        }\n    }\n}","angular\n.module('ShinyaNews.utils.directives')\n.directive('syIcon', syIcon);\n\n\nfunction syIcon() {\n    return {\n        restrict: 'E',\n        replace: true,\n        template: function($elem, $attr) {\n            var viewBox = $attr.viewbox || \"0 0 100 100\";\n            var name = $attr.name;\n\n            return [\n                '<svg viewBox=\"' + viewBox + '\">',\n                    '<use xlink:href=\"/public/img/icon-sprites.svg#' + name + '\"></use>',\n                '</svg>',\n            ].join('');\n        }\n    }\n}","angular\n.module('ShinyaNews.utils.directives')\n.directive('syStopPropagation', stopPropagation);\n\n\nfunction stopPropagation() {\n    return {\n        restrict: 'A',\n        link: function($scope, $elem, $attr) {\n            $elem.on('click', stopPropagation)\n            $elem.on('touchstart', stopPropagation)\n\n            function stopPropagation(e) {\n                e.stopPropagation()\n            }\n        }\n    }\n}","\nNewsStore.$inject = [\"$window\", \"store\", \"STORE_PREFIX\", \"TimeHelper\", \"TIME\"];\nOldNewsStore.$inject = [\"$cacheFactory\"];\nFetchNews.$inject = [\"$q\", \"$http\", \"NewsStore\", \"OldNewsStore\"];angular\n.module('ShinyaNews.utils.services')\n.constant('STORE_PREFIX', 'sy-news-')\n.factory('NewsStore', NewsStore)\n.factory('OldNewsStore', OldNewsStore)\n.factory('FetchNews', FetchNews)\n.run([\"store\", \"STORE_PREFIX\", \"NewsStore\", function (store, STORE_PREFIX, NewsStore){\n    // Clear Expired News\n    store.get(STORE_PREFIX + 'expiration-date') < Date.now() && NewsStore.removeAll()\n}]);\n\n\nfunction NewsStore($window, store, STORE_PREFIX, TimeHelper, TIME){\n    return {\n        get: get,\n        set: set,\n        removeAll: removeAll,\n    };\n\n\n    // Get News\n    function get(newsID) {\n        return store.get(STORE_PREFIX + newsID)\n    }\n    // Store News and Expiration Date\n    function set(newsID, news) {\n        store.set(STORE_PREFIX + newsID, news)\n        store.set(STORE_PREFIX + 'expiration-date', TimeHelper.todayMs() + TIME.ONE_DAY)\n    }\n    // Remove all News\n    function removeAll() {\n        var ls = $window.localStorage;\n        var reg = new RegExp('^' + STORE_PREFIX);\n\n        for (var i = 0, j = 0, len = localStorage.length; i < len; i++){\n            reg.test(ls.key(j))\n                ? store.remove(ls.key(j))\n            : j ++\n        }\n    }\n}\nfunction OldNewsStore($cacheFactory) {\n    return $cacheFactory('OldNewsStore')\n}\nfunction FetchNews($q, $http, NewsStore, OldNewsStore){\n    return function(date, country, isOldNews) {\n        var newsId = date + country;\n        var localNewsData = isOldNews ? OldNewsStore.get(newsId) : NewsStore.get(newsId);\n\n        return $q(function (resolve, reject){\n            if (!date || !country) {\n                reject('invalid params')\n                return;\n            };\n            // Fetch From Local\n            if (localNewsData) {\n                resolve(localNewsData)\n            }\n            // Fetch From Remote\n            else {\n                $http\n                .post('/api/getSelectedDateNews', {\n                    selectDate: date,\n                    selectCountry: country,\n                    isAllDay: isOldNews\n                })\n                .success(function (data, status, headers, config){\n                    switch (isOldNews) {\n                        case true:\n                            OldNewsStore.put(newsId, data.msg)\n                            break;\n                        case false:\n                            NewsStore.set(newsId, data.msg)\n                            break;\n                    }\n\n                    resolve(data.msg)\n                })\n                .error(function (data, status, headers, config){\n                    reject()\n                })\n            }\n        });\n    }\n}","\nTimeHelper.$inject = [\"$stateParams\"];angular\n.module('ShinyaNews.utils.services')\n.constant('TIME', {\n    ONE_HOUR: 1000 * 60 * 60,\n    ONE_DAY: 1000 * 60 * 60 * 24,\n    TWO_DAYS: 1000 * 60 * 60 * 48,\n})\n.factory('TimeHelper', TimeHelper);\n\n\nfunction TimeHelper($stateParams){\n    return {\n        nowHourMs: nowHourMs,\n        todayMs: todayMs,\n        newsDateMs: newsDateMs,\n        isToday: isToday,\n        dateFormatter: dateFormatter\n    };\n\n\n    function nowHourMs() {\n        var date = new Date();\n        return Date.parse(\n            new Date(\n                date.getFullYear(),\n                date.getMonth(),\n                date.getDate(),\n                date.getHours()\n            )\n        );\n    }\n    function todayMs() {\n        var date = new Date();\n        return  Date.parse(\n            new Date(\n                date.getFullYear(),\n                date.getMonth(),\n                date.getDate()\n            )\n        );\n    }\n    function newsDateMs(isOldNews){\n        var year    = $stateParams.year;\n        var month   = $stateParams.month;\n        var day     = $stateParams.day;\n        var hour    = $stateParams.h;\n\n        return Date.parse(new Date(year, month - 1, day, isOldNews ? null : hour));\n    }\n    function isToday() {\n        var year    = $stateParams.year;\n        var month   = $stateParams.month;\n        var day     = $stateParams.day;\n        var hour    = $stateParams.h;\n\n        var now = dateFormatter(Date.now());\n\n        return year == now.year && month == now.month && day == now.day;\n    }\n    function dateFormatter(dateMs) {\n        var date = new Date(dateMs);\n        return {\n            year : date.getFullYear(),\n            month: date.getMonth() + 1,\n            day  : date.getDate(),\n            hour : date.getHours()\n        };\n    }\n}","\nstore.$inject = [\"$window\"];angular\n.module('ShinyaNews.utils.services')\n.factory('store', store);\n\n\n/**\n * @name store\n * @desc LocalStorage that support Object and Array\n *\n */\nfunction store($window) {\n    return {\n        get: get,\n        set: set,\n        remove: remove\n    };\n\n\n    function get(key) {\n        return _parseJSON($window.localStorage.getItem(key))\n    }\n    function set(key, value) {\n        return $window.localStorage.setItem(key, JSON.stringify(value))\n    }\n    function remove(key) {\n        $window.localStorage.removeItem(key)\n    }\n    function _parseJSON(data) {\n        try {\n            data = JSON.parse(data)\n        } catch (e) {\n        } finally {\n            return data\n        }\n    }\n}\n"],"sourceRoot":"/source/"}