{"version":3,"sources":["entry.js","templates.js","Nav/Nav.js","NewsBox/NewsBox.js","TimeMachine/TimeMachine.js","utils.js","controllers/rootCtrl.js","directives/syAutofocus.js","directives/syIcon.js","directives/syStopPropagation.js","services/FetchNews.js","services/TimeHelper.js","services/store.js"],"names":["config","$locationProvider","$stateProvider","$urlRouterProvider","otherwise","now","Date","year","getFullYear","month","getMonth","day","getDate","h","getHours","country","JSON","parse","window","localStorage","getItem","html5Mode","state","url","join","templateUrl","controller","controllerAs","$inject","angular","module","run","$templateCache","put","syNav","restrict","replace","NavCtrl","$scope","$window","$timeout","$state","$stateParams","store","COUNTRIES","TIME","TimeHelper","selectNews","step","isOldNews","rootVM","newsDate","newsDateMs","vm","isShowCaretRight","isShowCaretLeft","nextDate","dateFormatter","ONE_DAY","go","q","nextHour","parseInt","handleKeyDownEsc","countryList","getInitCountry","handleKeyDownLeftOrRightArrow","event","payload","handleSwipeLeftOrRight","checkCaret","TWO_DAYS","ONE_HOUR","todayMs","togglehNewsType","nowHourMs","hour","handleCountryClick","newCountry","toggleCountryList","activeCounty","cache","length","forEach","push","hideCountryList","preList","copy","index","indexOf","splice","unshift","get","this","$on","constant","directive","NewsBoxCtrl","$rootScope","$location","FetchNews","updateState","newState","merge","updateQueryParam","title","searchText","notify","reload","handleSwipe","$broadcast","handleHeadingClick","document","querySelector","blur","handleKeyDownUpOrDownArrow","newsItemList","querySelectorAll","len","selectedNewsIndex","focus","fetchNews","isToday","date","set","then","newsData","isFetching","isFetchFail","$watch","newVal","oldVal","syTimeMachine","TimeMachineCtrl","toggleTimeMachine","timeMachine","Y","M","D","H","isShowTimeMachine","handleSubmit","formValidation","expectDate","maxDate","form","$setValidity","$watchCollection","rootCtrl","handleKeyDown","e","keyCode","target","tagName","toLowerCase","element","on","autoFocus","scope","link","$elem","$attr","timeout","syAutoFocus","syIcon","template","viewBox","viewbox","name","stopPropagation","NewsStore","STORE_PREFIX","newsID","news","removeAll","ls","reg","RegExp","i","j","test","key","remove","OldNewsStore","$cacheFactory","$q","$http","newsId","localNewsData","resolve","reject","post","selectDate","selectCountry","isAllDay","success","data","status","headers","msg","error","factory","dateMs","_parseJSON","value","setItem","stringify","removeItem"],"mappings":"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","file":"app.js","sourcesContent":["\nconfig.$inject = [\"$locationProvider\", \"$stateProvider\", \"$urlRouterProvider\"];angular\n.module('ShinyaNews', [\n    // Vendors\n    'ngTouch',\n    'ngAnimate',\n    'ui.router',\n    // App\n    'ShinyaNews.utils.controllers',\n    'ShinyaNews.utils.services',\n    'ShinyaNews.utils.directives',\n    'ShinyaNews.components.NewsBox',\n    'ShinyaNews.components.TimeMachine',\n    'ShinyaNews.components.Nav',\n    'ShinyaNews.templates',\n])\n.config(config);\n\n\nfunction config($locationProvider, $stateProvider, $urlRouterProvider) {\n\n    $urlRouterProvider.otherwise(function() {\n        var now     = new Date();\n        var year    = now.getFullYear();\n        var month   = now.getMonth() + 1;\n        var day     = now.getDate();\n        var h       = now.getHours();\n        var country = JSON.parse(window.localStorage.getItem('sy-country')) || \"HK\";\n\n        return country + '/' + year + '/' + month + '/' + day + '?h=' + h;\n    });\n\n    $locationProvider.html5Mode(true);\n\n    $stateProvider\n    .state('news', {\n        url: [\n            '/{country:BR|CN|DE|FR|HK|IN|JP|KR|RU|TW|US}', // Country\n            '/{year:201[5-6]}', // Year\n            '/{month:0?[1-9]|1[0-2]}', // Month\n            '/{day:0?[0-9]|[12][0-9]|3[0-1]}', // Day\n            '?h', // Hour\n            '&q', // Search\n        ].join(''),\n        templateUrl: 'components/NewsBox/NewsBox.html',\n        controller: 'NewsBoxCtrl',\n        controllerAs: 'newsVM'\n    })\n}","angular.module(\"ShinyaNews.templates\", []).run([\"$templateCache\", function($templateCache) {$templateCache.put(\"components/Nav/Caret.html\",\"<div>\\n\\n    <button\\n        ng-if=\\\"navVM.state.isShowCaretLeft\\\"\\n        ng-click=\\\"navVM.selectNews(-1)\\\"\\n        class=\\\"btn--caret btn--caret--left tips--deep animate--faster\\\"\\n    >\\n        <sy-icon name=\\\"caret-left\\\"></sy-icon>\\n    </button>\\n\\n    <button\\n        ng-if=\\\"navVM.state.isShowCaretRight\\\"\\n        ng-click=\\\"navVM.selectNews(1)\\\"\\n        class=\\\"btn--caret btn--caret--right tips--deep animate--faster\\\"\\n    >\\n        <sy-icon name=\\\"caret-right\\\"></sy-icon>\\n    </button>\\n\\n</div>\");\n$templateCache.put(\"components/Nav/ChooseCountry.html\",\"<div class=\\\"btn--t--l animate--faster\\\">\\n    <ul>\\n        <li ng-repeat=\\\"country in navVM.state.countryList\\\" class=\\\"animate--faster\\\">\\n            <button\\n                class=\\\"btn--country shadow animate--faster {{ \\'btn--country--\\' + country }}\\\"\\n                ng-click=\\\"navVM.handleCountryClick(country)\\\"\\n            >\\n                {{::country}}\\n            </button>\\n        </li>\\n    </ul>\\n</div>\");\n$templateCache.put(\"components/Nav/ClickableLogo.html\",\"<button class=\\\"btn--t--r\\\" ng-click=\\\"navVM.togglehNewsType()\\\">\\n    <span class=\\\"btn--logo animate--general\\\" alt=\\\"logo\\\"></span>\\n</button>\");\n$templateCache.put(\"components/Nav/Nav.html\",\"<div>\\n\\n    <div ng-include=\\\"\\'components/Nav/Caret.html\\'\\\"></div>\\n    <div ng-include=\\\"\\'components/Nav/ClickableLogo.html\\'\\\"></div>\\n    <div ng-include=\\\"\\'components/Nav/ChooseCountry.html\\'\\\"></div>\\n\\n<div>\");\n$templateCache.put(\"components/NewsBox/FetchState.html\",\"<!-- Not Found -->\\n<div ng-if=\\\"newsVM.state.isFetchFail\\\" class=\\\"newsState--fetchFail animate--general\\\">\\n    <sy-icon name=\\\"NotFound\\\" viewbox=\\\"0 0 474 584\\\"></sy-icon>\\n</div>\\n\\n<!-- Spin -->\\n<div ng-if=\\\"newsVM.state.isFetching\\\" class=\\\"newsState--fetching animate--general\\\"></div>\\n\");\n$templateCache.put(\"components/NewsBox/Heading.html\",\"<h3>\\n    <span ng-click=\\\"newsVM.handleHeadingClick()\\\" class=\\\"cursor--pointer\\\" role=\\\"button\\\">\\n        <span ng-if=\\\"!rootVM.state.isOldNews\\\">{{newsVM.state.newsDate | date:\\'HH:00\\'}}</span>\\n        <span ng-if=\\\"rootVM.state.isOldNews\\\">{{newsVM.state.newsDate | date:\\'yyyy-MM-dd\\'}}</span>\\n    </span>\\n</h3>\");\n$templateCache.put(\"components/NewsBox/NewsBox.html\",\"<div\\n    class=\\\"newsBox animate--general shadow\\\"\\n    ng-swipe-left=\\\"newsVM.handleSwipe(1)\\\"\\n    ng-swipe-right=\\\"newsVM.handleSwipe(-1)\\\"\\n    ng-swipe-disable-mouse\\n>\\n\\n    <!-- Heading -->\\n    <div ng-include=\\\"\\'components/NewsBox/Heading.html\\'\\\"></div>\\n\\n    <!-- Content -->\\n    <div class=\\\"newsBox__content overflow--y\\\">\\n\\n        <div ng-if=\\\"newsVM.state.newsData.length > 0\\\">\\n            <div ng-include=\\\"\\'components/NewsBox/SearchBar.html\\'\\\"></div>\\n        </div>\\n\\n        <div ng-if=\\\"newsVM.state.newsData.length > 0\\\" ng-include=\\\"\\'components/NewsBox/NewsItem.html\\'\\\"></div>\\n\\n        <div ng-include=\\\"\\'components/NewsBox/FetchState.html\\'\\\"></div>\\n\\n    </div>\\n</div>\");\n$templateCache.put(\"components/NewsBox/NewsItem.html\",\"<ul ng-repeat=\\\"sourceItem in newsVM.state.newsData | filter: newsVM.state.searchText\\\">\\n    <!-- Source: Provider -->\\n    <h4>{{::sourceItem.source_name}}</h4>\\n    <!-- Source: News -->\\n    <li\\n        ng-repeat=\\\"newsItem in sourceItem.news | orderBy: \\'date\\' | filter: newsVM.state.searchText\\\"\\n        class=\\\"newsItem\\\"\\n    >\\n\\n        <!-- News: Created At -->\\n        <span class=\\\"newsItem__createdAt\\\">{{::newsItem.date | date: \\'HH:mm\\'}}</span>\\n        <!-- News: Title -->\\n        <a class=\\\"newsItem__title\\\" ng-href=\\\"{{::newsItem.url}}\\\" target=\\\"_blank\\\">{{::newsItem.title}}</a>\\n        <!-- News: Source Link -->\\n        <button ng-click=\\\"newsVM.updateQueryParam(newsItem.title)\\\" class=\\\"newsItem__link\\\">\\n            <sy-icon name=\\\"link\\\"></sy-icon>\\n        </button>\\n\\n    </li>\\n</ul>\");\n$templateCache.put(\"components/NewsBox/SearchBar.html\",\"<form class=\\\"searchBar\\\" novalidate name=\\\"searchForm\\\">\\n\\n    <input\\n        class=\\\"searchBar__input cursor--pointer animate--faster\\\"\\n        ng-class=\\\"{\\'searchBar__input--valid\\': searchForm.$valid}\\\"\\n        ng-model=\\\"newsVM.state.searchText\\\"\\n        ng-model-options=\\\"{ debounce: 300 }\\\"\\n        type=\\\"text\\\"\\n        required\\n    >\\n\\n</form>\");\n$templateCache.put(\"components/TimeMachine/Form.html\",\"<form\\n    sy-stop-propagation\\n    ng-submit=\\\"tmVM.handleSubmit()\\\"\\n    class=\\\"timeMachine__form shadow animate--faster\\\"\\n    name=\\\"tmVM.form\\\"\\n    novalidate\\n>\\n    <div ng-if=\\\"!rootVM.state.isOldNews\\\">\\n        <input\\n            sy-auto-focus=\\\"700\\\"\\n            type=\\\"number\\\"\\n            placeholder=\\\"H\\\"\\n            ng-model=\\\"tmVM.state.timeMachine.H\\\"\\n            ng-model-options=\\\"{ debounce: 300 }\\\"\\n            class=\\\"timeMachine__input shadow--onFocus animate--faster\\\"\\n            min=\\\"1\\\"\\n            max=\\\"24\\\"\\n            required\\n        >\\n        <span>:</span>\\n        <input\\n            class=\\\"timeMachine__input shadow--onFocus animate--faster\\\"\\n            type=\\\"number\\\"\\n            placeholder=\\\"00\\\"\\n            disabled\\n        >\\n    </div>\\n    <div ng-if=\\\"rootVM.state.isOldNews\\\">\\n        <input\\n            class=\\\"timeMachine__input shadow--onFocus animate--faster\\\"\\n            ng-model=\\\"tmVM.state.timeMachine.Y\\\"\\n            ng-model-options=\\\"{ debounce: 300 }\\\"\\n            type=\\\"number\\\"\\n            placeholder=\\\"Y\\\"\\n            min=\\\"15\\\"\\n            max=\\\"16\\\"\\n            required\\n        >\\n        <span>-</span>\\n        <input\\n            class=\\\"timeMachine__input shadow--onFocus animate--faster\\\"\\n            ng-model=\\\"tmVM.state.timeMachine.M\\\"\\n            ng-model-options=\\\"{ debounce: 300 }\\\"\\n            type=\\\"number\\\"\\n            placeholder=\\\"M\\\"\\n            min=\\\"1\\\"\\n            max=\\\"12\\\"\\n            required\\n        >\\n        <span>-</span>\\n        <input\\n            class=\\\"timeMachine__input shadow--onFocus animate--faster\\\"\\n            ng-model=\\\"tmVM.state.timeMachine.D\\\"\\n            ng-model-options=\\\"{ debounce: 300 }\\\"\\n            sy-auto-focus=\\\"700\\\"\\n            type=\\\"number\\\"\\n            placeholder=\\\"D\\\"\\n            min=\\\"1\\\"\\n            max=\\\"31\\\"\\n            required\\n        >\\n    </div>\\n</form>\");\n$templateCache.put(\"components/TimeMachine/TimeMachine.html\",\"<div>\\n    <!-- Time Machine: Start Button -->\\n    <button ng-click=\\\"tmVM.toggleTimeMachine()\\\" class=\\\"btn--timeMachine tips--deep animate--faster\\\">\\n        <sy-icon name=\\\"time_machine\\\"></sy-icon>\\n    </button>\\n\\n    <!-- Time Machine: Content -->\\n    <div\\n        ng-if=\\\"tmVM.state.isShowTimeMachine\\\"\\n        ng-click=\\\"tmVM.toggleTimeMachine()\\\"\\n        class=\\\"timeMachine vertically_center animate--faster\\\"\\n    >\\n            <div class=\\\"timeMachine__content animate--general\\\">\\n                <div ng-include=\\\"\\'components/TimeMachine/Form.html\\'\\\"></div>\\n                <div ng-include=\\\"\\'components/TimeMachine/ToolBar.html\\'\\\"></div>\\n            </div>\\n    </div>\\n</div>\");\n$templateCache.put(\"components/TimeMachine/ToolBar.html\",\"<div sy-stop-propagation>\\n    <button\\n        ng-if=\\\"!tmVM.form.$invalid\\\"\\n        ng-click=\\\"tmVM.handleSubmit()\\\"\\n        class=\\\"timeMachine__btn tips\\\"\\n    >\\n        <sy-icon name=\\\"ok\\\"></sy-icon>\\n    </button>\\n    <button\\n        ng-click=\\\"tmVM.toggleTimeMachine()\\\"\\n        class=\\\"timeMachine__btn tips\\\"\\n    >\\n        <sy-icon name=\\\"cancel\\\"></sy-icon>\\n    </button>\\n</div>\");}]);","\nNavCtrl.$inject = [\"$scope\", \"$window\", \"$timeout\", \"$state\", \"$stateParams\", \"store\", \"COUNTRIES\", \"TIME\", \"TimeHelper\"];angular\n.module('ShinyaNews.components.Nav', [])\n.constant('COUNTRIES', ['HK', 'CN', 'JP', 'TW', 'US', 'BR', 'IN', 'KR', 'RU', 'DE', 'FR'])\n.directive('syNav', syNav);\n\n\nfunction syNav(){\n    return {\n        restrict: 'E',\n        replace: true,\n        controller: NavCtrl,\n        controllerAs: 'navVM',\n        templateUrl: 'components/Nav/Nav.html'\n    };\n}\nfunction NavCtrl(\n    $scope, $window, $timeout,\n    $state, $stateParams, store,\n    COUNTRIES, TIME, TimeHelper\n){\n\n    var vm = this;\n    this.state = {\n        isShowCaretLeft: true,\n        isShowCaretRight: true,\n        countryList: getInitCountry()\n    };\n    vm.selectNews = selectNews;\n    vm.togglehNewsType = togglehNewsType;\n    vm.handleCountryClick = handleCountryClick;\n\n    // Events\n    $scope.$on('keyDown:esc', handleKeyDownEsc)\n    $scope.$on('keyDown:leftOrRightArrow', handleKeyDownLeftOrRightArrow)\n    $scope.$on('swipe:leftOrRight', handleSwipeLeftOrRight)\n    $scope.$on('fetchNews:start', checkCaret)\n\n\n    function selectNews(step) {\n        var isOldNews = $scope.rootVM.state.isOldNews;\n        var newsDate = TimeHelper.newsDateMs(isOldNews);\n\n        // 屏蔽（移動端／鍵盤操作）無效的獲取新聞（滑動）\n        if (step === 1 && !vm.state.isShowCaretRight || step === -1 && !vm.state.isShowCaretLeft) return;\n\n        switch (isOldNews) {\n            case true:\n                var nextDate = TimeHelper.dateFormatter(newsDate + TIME.ONE_DAY * step);\n                $state.go('news', {\n                    year : nextDate.year,\n                    month: nextDate.month,\n                    day  : nextDate.day,\n                    h    : null,\n                    q    : null\n                });\n                break;\n            case false:\n                var nextHour = parseInt($stateParams.h || new Date().getHours()) + step;\n                $state.go('news', {\n                    h: nextHour,\n                    q: null\n                })\n                break;\n        }\n    }\n    function handleKeyDownEsc() {\n        vm.state.countryList = getInitCountry();\n    }\n    function handleKeyDownLeftOrRightArrow(event, payload) {\n        vm.selectNews(payload.step)\n    }\n    function handleSwipeLeftOrRight(event, payload) {\n        vm.selectNews(payload.step)\n    }\n    function checkCaret() {\n        var isOldNews = $scope.rootVM.state.isOldNews;\n        var newsDate = TimeHelper.newsDateMs(isOldNews);\n\n        switch (isOldNews) {\n            case true:\n                // Always Show Left\n                vm.state.isShowCaretLeft = true;\n                // Before Today\n                vm.state.isShowCaretRight = newsDate + TIME.TWO_DAYS <= Date.now();\n                break;\n            case false:\n                // After 0:00\n                vm.state.isShowCaretLeft = newsDate - TIME.ONE_HOUR !== TimeHelper.todayMs();\n                // Before Now Hour\n                vm.state.isShowCaretRight = newsDate + TIME.ONE_HOUR <= Date.now();\n                break;\n        }\n    }\n    function togglehNewsType() {\n        var isOldNews = $scope.rootVM.state.isOldNews;\n        var now;\n        switch (isOldNews){\n            // =>「新聞，」\n            case true:\n                now = TimeHelper.nowHourMs();\n                isOldNews = false\n                break;\n            // =>「舊聞。」\n            case false:\n                now = TimeHelper.todayMs() - TIME.ONE_DAY;\n                isOldNews = true\n                break;\n        }\n        now = TimeHelper.dateFormatter(now);\n\n        $state.go('news', {\n            year : now.year,\n            month: now.month,\n            day  : now.day,\n            h    : isOldNews ? null : now.hour,\n            q    : null\n        });\n    }\n    function handleCountryClick(newCountry) {\n        switch (newCountry === vm.state.countryList[0]) {\n            // Select Country\n            case true:\n                toggleCountryList(newCountry)\n                break;\n            // Change Country\n            case false:\n                $state.go('news', { country: newCountry })\n                hideCountryList(newCountry)\n                break;\n        }\n\n\n        function toggleCountryList(newCountry) {\n            var activeCounty = vm.state.countryList[0];\n            var cache = [activeCounty];\n\n            switch (vm.state.countryList.length === 1) {\n                // Show Country List\n                case true:\n                    COUNTRIES.forEach(function(country) {\n                        activeCounty !== country && cache.push(country);\n                    })\n                    vm.state.countryList = cache;\n                    break;\n                // Hide Country List\n                case false:\n                    hideCountryList(newCountry)\n                    break;\n            }\n        }\n        function hideCountryList(newCountry) {\n            // Insert newCountry to No.1\n            var preList = angular.copy(vm.state.countryList);\n            var index = preList.indexOf(newCountry);\n            preList.splice(index, 1)\n            preList.unshift(newCountry)\n            vm.state.countryList = preList;\n\n            // Hide Coutry List\n            $timeout(function (){\n                if (newCountry === preList[0]){\n                    vm.state.countryList = [newCountry]\n                }\n            })\n        }\n    }\n    function getInitCountry() {\n        return [store.get('sy-country') || 'HK'];\n    }\n}","\nNewsBoxCtrl.$inject = [\"$rootScope\", \"$scope\", \"$location\", \"$state\", \"$stateParams\", \"store\", \"TimeHelper\", \"FetchNews\"];angular\n.module('ShinyaNews.components.NewsBox', [])\n.controller('NewsBoxCtrl', NewsBoxCtrl);\n\n\nfunction NewsBoxCtrl(\n    $rootScope, $scope, $location,\n    $state, $stateParams,\n    store, TimeHelper, FetchNews\n){\n\n    var vm = this;\n    vm.state = {\n        isFetching: true,\n        isFetchFail: false,\n        newsData: [],\n        newsDate: 0,\n        selectedNewsIndex: -1,\n        searchText: $stateParams.q,\n    };\n    vm.updateState = updateState;\n    vm.updateQueryParam = updateQueryParam;\n    vm.handleSwipe = handleSwipe;\n    vm.handleHeadingClick = handleHeadingClick;\n\n    // Events\n    $scope.$on('keyDown:esc', handleKeyDownEsc)\n    $scope.$on('keyDown:upOrDownArrow', handleKeyDownUpOrDownArrow)\n    $scope.$watch('newsVM.state.searchText', function(newVal, oldVal) {\n        if (newVal !== oldVal){\n            vm.updateQueryParam(newVal)\n        }\n    })\n\n    // Fetch News\n    fetchNews()\n\n\n    function updateState(newState) {\n        angular.merge(vm.state, newState)\n    }\n    function updateQueryParam(title) {\n        vm.updateState({ searchText: title })\n        $state.go('news', {\n            q: title\n        }, { notify: false, reload: true })\n    }\n    function handleSwipe(step){\n        $rootScope.$broadcast('swipe:leftOrRight', { step: step })\n    }\n    function handleHeadingClick() {\n        $rootScope.$broadcast('toggleTimeMachine')\n    }\n    function handleKeyDownEsc() {\n        vm.updateQueryParam('')\n        document.querySelector('.searchBar__input').blur()\n    }\n    function handleKeyDownUpOrDownArrow(event, payload) {\n        // Foucs News Item\n        var newsItemList = document.querySelectorAll('.newsItem__title');\n        var len = newsItemList.length;\n\n        if (len <= 0) return;\n\n        var step = payload.step;\n        var index = vm.state.selectedNewsIndex;\n\n        if (step === -1 && index > 0 && index < len) {\n            index--;\n        }\n        else if (step === 1 && index >= -1 && index < len - 1) {\n            index++;\n        }\n\n        newsItemList[index].focus()\n        vm.updateState({ selectedNewsIndex: index })\n    }\n    function fetchNews() {\n        var country = $stateParams.country;\n        var isOldNews = !TimeHelper.isToday();\n        var date = TimeHelper.newsDateMs(isOldNews);\n\n        // Store Country\n        store.set('sy-country', country)\n\n        // Update Date\n        vm.updateState({\n            newsDate: date\n        })\n\n        // Start Fetch News\n        $rootScope.$broadcast('fetchNews:start')\n\n        FetchNews(date, country, isOldNews)\n        .then(function(newsData) {\n            vm.updateState({\n                isFetching: false,\n                isFetchFail: false,\n                newsData: newsData\n            })\n        })\n        .catch(function() {\n            vm.updateState({\n                isFetching: false,\n                isFetchFail: true\n            })\n        })\n        .finally(function() {\n            $scope.rootVM.updateState({\n                isOldNews: isOldNews\n            })\n        })\n    }\n}","\nTimeMachineCtrl.$inject = [\"$scope\", \"$state\", \"$stateParams\", \"TimeHelper\"];angular\n.module('ShinyaNews.components.TimeMachine', [])\n.directive('syTimeMachine', syTimeMachine);\n\n\nfunction syTimeMachine() {\n    return {\n        restrict: 'E',\n        replace: true,\n        controller: TimeMachineCtrl,\n        controllerAs: 'tmVM',\n        templateUrl: 'components/TimeMachine/TimeMachine.html'\n    }\n}\nfunction TimeMachineCtrl($scope, $state, $stateParams, TimeHelper) {\n    var vm = this;\n    vm.state = {\n        isShowTimeMachine: false,\n        timeMachine: {\n            Y: 0,\n            M: 0,\n            D: 0,\n            H: 0\n        }\n    };\n    vm.toggleTimeMachine = toggleTimeMachine;\n    vm.handleSubmit = handleSubmit;\n\n    $scope.$on('keyDown:esc', handleKeyDownEsc)\n    $scope.$on('toggleTimeMachine', toggleTimeMachine)\n    $scope.$watchCollection('tmVM.state.timeMachine', formValidation)\n\n\n    function toggleTimeMachine() {\n        // Init Time Machine Date info\n        var newsDate = TimeHelper.newsDateMs($scope.rootVM.state.isOldNews);\n        var now = TimeHelper.dateFormatter(newsDate);\n        vm.state.timeMachine = {\n            Y: now.year % 2000,\n            M: now.month,\n            D: now.day,\n            H: now.hour\n        };\n        // Show / Hide Time Machine\n        vm.state.isShowTimeMachine = !vm.state.isShowTimeMachine\n    }\n    function handleKeyDownEsc() {\n        vm.state.isShowTimeMachine && vm.toggleTimeMachine()\n    }\n    function handleSubmit() {\n        switch ($scope.rootVM.state.isOldNews) {\n            // Only Change `Year`, `Month` and `Day`\n            case true:\n                $state.go('news', {\n                    year : '20' + vm.state.timeMachine.Y,\n                    month: vm.state.timeMachine.M,\n                    day  : vm.state.timeMachine.D,\n                    h    : null,\n                    q    : null\n                })\n                break;\n            // Only Change `Hour`\n            case false:\n                var h = vm.state.timeMachine.H;\n\n                $state.go('news', { h: h, q: null })\n                break;\n        }\n        // Hide Time Machine\n        vm.state.isShowTimeMachine = false\n    }\n    function formValidation(newVal, oldVal) {\n        var maxDate = Date.now()\n        var expectDate;\n\n        switch ($scope.rootVM.state.isOldNews) {\n            case true:\n                expectDate = (\n                    Date.parse(new Date(\n                        '20' + vm.state.timeMachine.Y,\n                        vm.state.timeMachine.M - 1,\n                        vm.state.timeMachine.D\n                    ))\n                );\n                break;\n            case false:\n                expectDate = (\n                    Date.parse(new Date(\n                        new Date().getFullYear(),\n                        new Date().getMonth(),\n                        new Date().getDate(),\n                        vm.state.timeMachine.H\n                    ))\n                );\n                break;\n        }\n\n        vm.form && vm.form.$setValidity('maxDate', expectDate <= maxDate)\n    }\n}","angular.module('ShinyaNews.utils.controllers', []);\nangular.module('ShinyaNews.utils.services', []);\nangular.module('ShinyaNews.utils.directives', []);","\nrootCtrl.$inject = [\"$rootScope\", \"$window\"];angular\n.module('ShinyaNews.utils.controllers')\n.controller('rootCtrl', rootCtrl);\n\n\nfunction rootCtrl($rootScope, $window){\n    var vm = this;\n    vm.state = {\n        isOldNews: false\n    };\n    vm.updateState = updateState;\n\n    // Events\n    angular.element($window).on('keydown', handleKeyDown)\n\n\n    function updateState(newState) {\n        angular.merge(vm.state, newState)\n    }\n    function handleKeyDown(e) {\n        var keyCode = e.keyCode;\n        var target = e.target.tagName.toLowerCase();\n\n        switch (keyCode) {\n            case 27: // esc\n                $rootScope.$broadcast('keyDown:esc')\n                break;\n            case 37: // ←\n            case 39: // →\n                if (target === 'input') return;\n                $rootScope.$broadcast('keyDown:leftOrRightArrow', { step: keyCode === 37 ? -1 : 1 })\n                break;\n            case 38: // ↑\n            case 40: // ↓\n                if (target === 'input') return;\n                $rootScope.$broadcast('keyDown:upOrDownArrow', { step: keyCode === 38 ? -1 : 1 })\n                break;\n        }\n    }\n}","\nautoFocus.$inject = [\"$timeout\"];angular\n.module('ShinyaNews.utils.directives')\n.directive('syAutoFocus', autoFocus);\n\n\nfunction autoFocus($timeout) {\n    return {\n        restrict: 'A',\n        scope: {},\n        link: function($scope, $elem, $attr) {\n            var timeout = ~~$attr.syAutoFocus || 0;\n\n            $timeout(function (){\n                $elem[0].focus()\n            }, timeout)\n        }\n    }\n}","angular\n.module('ShinyaNews.utils.directives')\n.directive('syIcon', syIcon);\n\n\nfunction syIcon() {\n    return {\n        restrict: 'E',\n        replace: true,\n        template: function($elem, $attr) {\n            var viewBox = $attr.viewbox || \"0 0 100 100\";\n            var name = $attr.name;\n\n            return [\n                '<svg viewBox=\"' + viewBox + '\">',\n                    '<use xlink:href=\"/public/img/icon-sprites.svg#' + name + '\"></use>',\n                '</svg>',\n            ].join('');\n        }\n    }\n}","angular\n.module('ShinyaNews.utils.directives')\n.directive('syStopPropagation', stopPropagation);\n\n\nfunction stopPropagation() {\n    return {\n        restrict: 'A',\n        link: function($scope, $elem, $attr) {\n            $elem.on('click', stopPropagation)\n            $elem.on('touchstart', stopPropagation)\n\n            function stopPropagation(e) {\n                e.stopPropagation()\n            }\n        }\n    }\n}","\nNewsStore.$inject = [\"$window\", \"store\", \"STORE_PREFIX\", \"TimeHelper\", \"TIME\"];\nOldNewsStore.$inject = [\"$cacheFactory\"];\nFetchNews.$inject = [\"$q\", \"$http\", \"NewsStore\", \"OldNewsStore\"];angular\n.module('ShinyaNews.utils.services')\n.constant('STORE_PREFIX', 'sy-news-')\n.factory('NewsStore', NewsStore)\n.factory('OldNewsStore', OldNewsStore)\n.factory('FetchNews', FetchNews)\n.run([\"store\", \"STORE_PREFIX\", \"NewsStore\", function (store, STORE_PREFIX, NewsStore){\n    // Clear Expired News\n    store.get(STORE_PREFIX + 'expiration-date') < Date.now() && NewsStore.removeAll()\n}]);\n\n\nfunction NewsStore($window, store, STORE_PREFIX, TimeHelper, TIME){\n    return {\n        get: get,\n        set: set,\n        removeAll: removeAll,\n    };\n\n\n    // Get News\n    function get(newsID) {\n        return store.get(STORE_PREFIX + newsID)\n    }\n    // Store News and Expiration Date\n    function set(newsID, news) {\n        store.set(STORE_PREFIX + newsID, news)\n        store.set(STORE_PREFIX + 'expiration-date', TimeHelper.todayMs() + TIME.ONE_DAY)\n    }\n    // Remove all News\n    function removeAll() {\n        var ls = $window.localStorage;\n        var reg = new RegExp('^' + STORE_PREFIX);\n\n        for (var i = 0, j = 0, len = localStorage.length; i < len; i++){\n            reg.test(ls.key(j))\n                ? store.remove(ls.key(j))\n            : j ++\n        }\n    }\n}\nfunction OldNewsStore($cacheFactory) {\n    return $cacheFactory('OldNewsStore')\n}\nfunction FetchNews($q, $http, NewsStore, OldNewsStore){\n    return function(date, country, isOldNews) {\n        var newsId = date + country;\n        var localNewsData = isOldNews ? OldNewsStore.get(newsId) : NewsStore.get(newsId);\n\n        return $q(function (resolve, reject){\n            if (!date || !country) {\n                reject('invalid params')\n                return;\n            };\n            // Fetch From Local\n            if (localNewsData) {\n                resolve(localNewsData)\n            }\n            // Fetch From Remote\n            else {\n                $http\n                .post('/api/getSelectedDateNews', {\n                    selectDate: date,\n                    selectCountry: country,\n                    isAllDay: isOldNews\n                })\n                .success(function (data, status, headers, config){\n                    switch (isOldNews) {\n                        case true:\n                            OldNewsStore.put(newsId, data.msg)\n                            break;\n                        case false:\n                            NewsStore.set(newsId, data.msg)\n                            break;\n                    }\n\n                    resolve(data.msg)\n                })\n                .error(function (data, status, headers, config){\n                    reject()\n                })\n            }\n        });\n    }\n}","\nTimeHelper.$inject = [\"$stateParams\"];angular\n.module('ShinyaNews.utils.services')\n.constant('TIME', {\n    ONE_HOUR: 1000 * 60 * 60,\n    ONE_DAY: 1000 * 60 * 60 * 24,\n    TWO_DAYS: 1000 * 60 * 60 * 48,\n})\n.factory('TimeHelper', TimeHelper);\n\n\nfunction TimeHelper($stateParams){\n    return {\n        nowHourMs: nowHourMs,\n        todayMs: todayMs,\n        newsDateMs: newsDateMs,\n        isToday: isToday,\n        dateFormatter: dateFormatter\n    };\n\n\n    function nowHourMs() {\n        var date = new Date();\n        return Date.parse(\n            new Date(\n                date.getFullYear(),\n                date.getMonth(),\n                date.getDate(),\n                date.getHours()\n            )\n        );\n    }\n    function todayMs() {\n        var date = new Date();\n        return  Date.parse(\n            new Date(\n                date.getFullYear(),\n                date.getMonth(),\n                date.getDate()\n            )\n        );\n    }\n    function newsDateMs(isOldNews){\n        var year    = $stateParams.year;\n        var month   = $stateParams.month;\n        var day     = $stateParams.day;\n        var hour    = $stateParams.h;\n\n        return Date.parse(new Date(year, month - 1, day, isOldNews ? null : hour));\n    }\n    function isToday() {\n        var year    = $stateParams.year;\n        var month   = $stateParams.month;\n        var day     = $stateParams.day;\n        var hour    = $stateParams.h;\n\n        var now = dateFormatter(Date.now());\n\n        return year == now.year && month == now.month && day == now.day;\n    }\n    function dateFormatter(dateMs) {\n        var date = new Date(dateMs);\n        return {\n            year : date.getFullYear(),\n            month: date.getMonth() + 1,\n            day  : date.getDate(),\n            hour : date.getHours()\n        };\n    }\n}","\nstore.$inject = [\"$window\"];angular\n.module('ShinyaNews.utils.services')\n.factory('store', store);\n\n\n/**\n * @name store\n * @desc LocalStorage that support Object and Array\n *\n */\nfunction store($window) {\n    return {\n        get: get,\n        set: set,\n        remove: remove\n    };\n\n\n    function get(key) {\n        return _parseJSON($window.localStorage.getItem(key))\n    }\n    function set(key, value) {\n        return $window.localStorage.setItem(key, JSON.stringify(value))\n    }\n    function remove(key) {\n        $window.localStorage.removeItem(key)\n    }\n    function _parseJSON(data) {\n        try {\n            data = JSON.parse(data)\n        } catch (e) {\n        } finally {\n            return data\n        }\n    }\n}\n"],"sourceRoot":"/source/"}